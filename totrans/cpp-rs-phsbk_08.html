<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Data modeling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Data modeling</h1>
<blockquote>原文：<a href="https://cel.cs.brown.edu/crp/idioms/data_modeling.html">https://cel.cs.brown.edu/crp/idioms/data_modeling.html</a></blockquote>
                        
<p>In C++ the mechanisms available for data modeling are classes, enums, and
unions.</p>
<p>Rust, on the other hand, uses records
(<a href="https://doc.rust-lang.org/book/ch05-00-structs.html">structs</a>) and algebraic
data types (<a href="https://doc.rust-lang.org/book/ch06-00-enums.html">enums</a>).</p>
<p>Although Rust supports one major piece of object oriented design, polymorphism
using interfaces, Rust also has language features for modeling things using
algebraic data types (which in simple cases are like a much more ergonomic
<code>std::variant</code>).</p>
<p>This section gives examples of common constructions used when programming in C++
and how to achieve the same effects using Rust's features.</p>
<h2 id="fixed-operations-varying-data"><a class="header" href="#fixed-operations-varying-data">Fixed operations, varying data</a></h2>
<p>In situations where one needs to model a fixed set of operations that clients
will use, but the data that implements those operations are not fixed ahead of
time, the approach in C++ and the approach in Rust are the same. In both cases
interfaces that define the required operations are defined. Concrete types,
possibly defined by the client, implement those interfaces.</p>
<p>This way of modeling data can make use of either
<a href="./data_modeling/abstract_classes.html">dynamic</a> or <a href="./data_modeling/concepts.html">static
dispatch</a>, each of which is covered in its
own section.</p>
<h2 id="fixed-data-varying-operations"><a class="header" href="#fixed-data-varying-operations">Fixed data, varying operations</a></h2>
<p>In situations where there is a fixed set of data but the operations that the
data must support vary, there are a few approaches in C++. Which approaches are
available to use depend on the version of the standard in use.</p>
<p>In older versions of the standard, one might use manually defined tagged unions.
In newer versions, <code>std::variant</code> is available to improve the safety and
ergonomics of tagged unions. <a href="./data_modeling/tagged_unions.html">Both of these approaches map to the same approach
in Rust</a>.</p>
<p>Additionally, despite it not being strictly necessary to model a fixed set of
variants, the visitor pattern is sometimes used for this situation, especially
when using versions of the C++ standard before the introduction of
<code>std::variant</code>. In most of these cases the idiomatic Rust solution is the same
as what one would do when converting a C++ solution that uses <a href="./data_modeling/tagged_unions.html">tagged
unions</a>. The chapter on the <a href="../patterns/visitor.html">visitor
pattern</a> describes when to use a Rust version of the
visitor pattern or when to use Rust's enums (which are closer to <code>std::variant</code>
than to C++ enums) to model the data.</p>
<h2 id="varying-data-and-operations"><a class="header" href="#varying-data-and-operations">Varying data and operations</a></h2>
<p>When both data and operations may be extended by a client, the required
solutions are more complex. In C++, the approach usually involves some kind of
extension to the <a href="../patterns/visitor.html">visitor pattern</a> along with dynamic
casting. Because Rust does not support the kind of RTTI necessary for a dynamic
cast operator, different approaches need to be used. Some of those approaches
are discussed in the <a href="../patterns/visitor.html#expression-problem">chapter on the visitor
pattern</a>.</p>


                        <a class="feedback-link" href="https://docs.google.com/forms/d/e/1FAIpQLScoygeNlygODY2owQ-HvU8VGx3hi50aic7ZlKCyhJ0VktjiCg/viewform?usp=pp_url&amp;entry.1450251950=Data modeling">Click here to leave us feedback about this page.</a>
                        
</body>
</html>