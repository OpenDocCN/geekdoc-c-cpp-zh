<html><head></head><body>
<main class="calibre3">
<div id="chapter06" class="author">
<header class="calibre6">
<h2 id="calibre_toc_8" class="calibre7"><span class="first-last">Chapter<span class="first-last"> </span></span><span class="first-last">7<span class="first-last">. </span></span>The Toolchain</h2></header></div></main>

<main class="calibre3">
<div id="chapter06" class="author">
<section id="compiled_v_interpreted"><header class="calibre8"><h2 class="calibre7" id="calibre_pb_48"><span class="first-last">1<span class="first-last"> </span></span>Compiled v Interpreted Programs</h2></header><section id="compiled_v_interpreted_s1"><header class="calibre8"><h3 class="calibre2"><span class="first-last">1<span class="first-last">.</span>1<span class="first-last"> </span></span>Compiled Programs</h3></header><p class="releaseinfo">So far we have discussed how a program is loaded into
    virtual memory, started as a process kept track of by the
    operating system and interacts with via system calls.</p><p class="releaseinfo">A program that can be loaded directly into memory needs to
    be in a straight <em class="calibre5">binary</em> format.  The process
    of converting source code, written in a language such as C, to a
    binary file ready to be executed is called
    <em class="calibre5">compiling</em>.  Not surprisingly, the process is
    done by a <em class="calibre5">compiler</em>; the most widespread
    example being <span>gcc</span>.
    </p></section><section id="compiled_v_interpreted_s2"><header class="calibre8"><h3 class="calibre2"><span class="first-last">1<span class="first-last">.</span>2<span class="first-last"> </span></span>Interpreted programs</h3></header><p class="releaseinfo">Compiled programs have some disadvantages for modern
      software development.  Every time a developer makes a change,
      the compiler must be invoked to recreate the executable file.
      It is a logical extension to design a compiled program that can
      read <em class="calibre5">another</em> program listing and execute
      the code line by line.
      </p><p class="releaseinfo">We call this type of compiled program a
      <em class="calibre5">interpreter</em> because it interprets each line
      of the input file and executes it as code.  This way the program
      does not need to be compiled, and any changes will be seen the
      next time the interpreter runs the code.</p><p class="releaseinfo">For their convenience, interpreted programs usually run
      slower than a compiled counterpart.  The overhead in the program
      reading and interpreting the code each time is only encountered
      once for a compiled program, whilst an interpreted program
      encounters it each time it is run.</p><p class="releaseinfo">But interpreted languages have many positive aspects.
      Many interpreted languages actually run in a
      <code class="computeroutput1">virtual machine</code> that is
      abstracted from the underlying hardware.  Python and Perl 6 are
      languages that implement a virtual machine that interpreted code
      runs on.</p><section id="compiled_v_interpreted_s2_s1"><header class="calibre8"><h4 class="calibre21"><span class="first-last">1<span class="first-last">.</span>2<span class="first-last">.</span>1<span class="first-last"> </span></span>Virtual Machines</h4></header><p class="releaseinfo">A compiled program is completely dependent on the
        hardware of the machine it is compiled for, since it must be
        able to simply be copied to memory and executed.  A virtual
        machine is an abstraction of hardware into software.</p><p class="releaseinfo">For example, Java is a hybrid language that is partly
      compiled and partly interpreted.  Java code is complied into a
      program that runs inside a <em class="calibre5">Java Virtual
      Machine</em> or more commonly referred to as a JVM.  This
      means that a compiled program can run on any hardware that has a
      JVM written for it; so called <em class="calibre5">write one, run
      anywhere</em>.</p></section></section></section></div></main>

<main class="calibre3">
<div id="chapter06" class="author">
<section id="building_an_executable"><header class="calibre8"><h2 class="calibre7" id="calibre_pb_49"><span class="first-last">2<span class="first-last"> </span></span>Building an executable</h2></header><p class="releaseinfo">When we talk about the compiler, there are actually three
    separate steps involved in creating the executable file.</p><ol class="orderedlist"><li class="calibre11"><p class="releaseinfo">Compiling</p></li><li class="calibre11"><p class="releaseinfo">Assembling</p></li><li class="calibre11"><p class="releaseinfo">Linking</p></li></ol><p class="releaseinfo">The components involved in this process are collectively
    called the <em class="calibre5">toolchain</em> because the tools
    <em class="calibre5">chain</em> the output of one to the input of the
    other to create the final output.</p><p class="releaseinfo">Each link in the chain takes the source code progressively
    closer to being binary code suitable for execution.</p></section></div></main>

<main class="calibre3">
<div id="chapter06" class="author">
<section id="compiling"><header class="calibre8"><h2 class="calibre7" id="calibre_pb_50"><span class="first-last">3<span class="first-last"> </span></span>Compiling</h2></header><section id="compiling_s1"><header class="calibre8"><h3 class="calibre2"><span class="first-last">3<span class="first-last">.</span>1<span class="first-last"> </span></span>The process of compiling</h3></header><p class="releaseinfo">The first step of compiling a source file to an executable
    file is converting the code from the high level, human
    understandable language to <em class="calibre5">assembly code</em>.  We
    know from previous chapters than assembly code works directly with
    the instructions and registers provided by the processor.</p><p class="releaseinfo">The compiler is the most complex step of process for a
    number of reasons.  Firstly, humans are very unpredictable and
    have their source code in many different forms.  The compiler is
    only interested the actual code, however humans need things like
    comments and whitespace (spaces, tabs, indents, etc) to understand
    code.  The process that the compiler takes to convert the
    human-written source code to its internal representation is called
    <em class="calibre5">parsing</em>.</p><section id="compiling_s1_s1"><header class="calibre8"><h4 class="calibre21"><span class="first-last">3<span class="first-last">.</span>1<span class="first-last">.</span>1<span class="first-last"> </span></span>C code</h4></header><p class="releaseinfo">With C code, there is actually a step
	<em class="calibre5">before</em> parsing the source code called the
	<em class="calibre5">pre-processor</em>.  The pre-processor is at
	its core a text replacement program.  For example, any
	variable declared as <code class="computeroutput1">#define variable
	text</code> will have
	<code class="computeroutput1">variable</code> replaced with
	<code class="computeroutput1">text</code>.  This preprocessed code
	is then passed into the compiler.</p></section></section><section id="compiling_s2"><header class="calibre8"><h3 class="calibre2"><span class="first-last">3<span class="first-last">.</span>2<span class="first-last"> </span></span>Syntax</h3></header><p class="releaseinfo">Any computing language has a particular
      <em class="calibre5">syntax</em> that describes the rules of the
      language.  Both you and the compiler know the syntax rules, and
      all going well you will understand each other.  Humans, being as
      they are, often forget the rules or break them, leading the
      compiler to be unable to understand your intentions.  For
      example, if you were to leave the closing bracket off a
      <code class="computeroutput1">if</code> condition, the compiler does
      not know where the actual conditional is.</p><p class="releaseinfo">Syntax is most often described in <em class="calibre5">Backus-Naur
      Form</em> (BNF)<span id="compiling_s2_para2_footnote1-fnote">In fact the most common
      form is Extended Backus-Naur Form, or EBNF, as it allows some
      extra rules which are more suitable for modern
      languages.</span> which is a language with which you
      can describe languages!</p></section><section id="compiling_s3"><header class="calibre8"><h3 class="calibre2"><span class="first-last">3<span class="first-last">.</span>3<span class="first-last"> </span></span>Assembly Generation</h3></header><p class="releaseinfo">The job of the compiler is to translate the higher level
      language into assembly code suitable for the target being
      compiled for.  Obviously each different architecture has a
      different instruction set, different numbers of registers and
      different rules for correct operation.</p><section id="compiling_s3_s1"><header class="calibre8"><h4 class="calibre21"><span class="first-last">3<span class="first-last">.</span>3<span class="first-last">.</span>1<span class="first-last"> </span></span>Alignment</h4></header><div id="compiling_s3_s1_fig1" class="figure"><div class="author" summary="CPU's can generally only load values into registers from memory on specific alignments. Unaligned loads lead to, at best, performance degradation."><div class="media"><picture><img src="alignment.svg" alt="CPU's can generally only load values into registers from memory on specific alignments. Unaligned loads lead to, at best, performance degradation." class="calibre12"/></picture></div></div><header class="calibre8"><div class="title"><span>Figure<span> </span></span><span>3<span>.</span>3<span>.</span>1<span>.</span>1<span> </span></span>Alignment</div></header></div><p class="releaseinfo">Alignment of variables in memory is an important
	consideration for the compiler. Systems programmers need to be
	aware of alignment constraints to help the compiler create the
	most efficient code it can.</p><p class="releaseinfo">CPUs can generally not load a value into a register from
	an arbitrary memory location.  It requires that variables be
	<em class="calibre5">aligned</em> on certain boundaries.  In the
	example above, we can see how a 32 bit (4 byte) value is
	loaded into a register on a machine that requires 4 byte
	alignment of variables.</p><p class="releaseinfo">The first variable can be directly loaded into a
	register, as it falls between 4 byte boundaries.  The second
	variable, however, spans the 4 byte boundary.  This means that
	at minimum two loads will be required to get the variable into
	a single register; firstly the lower half and then the upper
	half.</p><p class="releaseinfo">Some architectures, such as x86, can handle unaligned
	loads in hardware and the only symptoms will be lower
	performance as the hardware does the extra work to get the
	value into the register.  Others architectures can not have
	alignment rules violated and will raise an exception which is
	generally caught by the operating system which then has to
	manually load the register in parts, causing even more
	overheads.</p><section id="compiling_s3_s1_s1"><header class="calibre8"><h5 class="calibre24"><span class="first-last">3<span class="first-last">.</span>3<span class="first-last">.</span>1<span class="first-last">.</span>1<span class="first-last"> </span></span>Structure Padding</h5></header><p class="releaseinfo">Programmers need to consider alignment especially when
	creating <code class="computeroutput1">struct</code>s.  Whilst the
	compiler knows the alignment rules for the architecture it is
	building for, at times programmers can cause sub-optimal
	behaviour.</p><p class="releaseinfo">The C99 standard only says that structures will be
	  ordered in memory in the same order as they are specified in
	  the declaration, and that in an array of structures all
	  elements will be the same size.</p><div id="struct-padding" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="36"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ cat struct.c</code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#include &lt;stdio.h&gt;</code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">struct a_struct {</code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        char char_one;</code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        char char_two;</code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        int int_one;</code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">};</code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">int main(void)</code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">{</code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        struct a_struct s;</code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        printf("%p : s.char_one\n" \</code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">               "%p : s.char_two\n" \</code></span></span>
<span class="line" db-line="17"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">               "%p : s.int_one\n", &amp;s.char_one,</code></span></span>
<span class="line" db-line="18"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">               &amp;s.char_two, &amp;s.int_one);</code></span></span>
<span class="line" db-line="19"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="20"><span class="ln">20 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        return 0;</code></span></span>
<span class="line" db-line="21"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="22"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">}</code></span></span>
<span class="line" db-line="23"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="24"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ gcc -o struct struct.c</code></span></span>
<span class="line" db-line="25"><span class="ln">25 <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="26"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ gcc -fpack-struct -o struct-packed struct.c</code></span></span>
<span class="line" db-line="27"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="28"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ ./struct</code></span></span>
<span class="line" db-line="29"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x7fdf6798 : s.char_one</code></span></span>
<span class="line" db-line="30"><span class="ln">30 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x7fdf6799 : s.char_two</code></span></span>
<span class="line" db-line="31"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x7fdf679c : s.int_one</code></span></span>
<span class="line" db-line="32"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="33"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ ./struct-packed</code></span></span>
<span class="line" db-line="34"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x7fcd2778 : s.char_one</code></span></span>
<span class="line" db-line="35"><span class="ln">35 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x7fcd2779 : s.char_two</code></span></span>
<span class="line" db-line="36"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x7fcd277a : s.int_one</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>3<span>.</span>3<span>.</span>1<span>.</span>1<span>.</span>1<span> </span></span>Struct padding example</div></header></div><p class="releaseinfo">In the example above, we contrive a structure that has
	  two bytes (<code class="computeroutput1">chars</code> followed
	  by a 4 byte integer.  The compiler pads the structure as
	  below.</p><div id="compiling_s3_s1_s1_fig1" class="figure"><div class="author" summary="The compiler pads the structure to align the integer on a 4 byte boundary."><div class="media"><picture><img src="padding.svg" alt="The compiler pads the structure to align the integer on a 4 byte boundary." class="calibre12"/></picture></div></div><header class="calibre8"><div class="title"><span>Figure<span> </span></span><span>3<span>.</span>3<span>.</span>1<span>.</span>1<span>.</span>1<span> </span></span>Alignment</div></header></div><p class="releaseinfo">In the other example we direct the compiler
	  <em class="calibre5">not</em> to pad structures and
	  correspondingly we can see that the integer starts directly
	  after the two <code class="computeroutput1">chars</code>.</p></section><section id="compiling_s3_s1_s2"><header class="calibre8"><h5 class="calibre24"><span class="first-last">3<span class="first-last">.</span>3<span class="first-last">.</span>1<span class="first-last">.</span>2<span class="first-last"> </span></span>Cache line alignment</h5></header><p class="releaseinfo">We talked previously about aliasing in the cache, and
	  how several addresses may map to the same cache line.
	  Programmers need to be sure that when they write their
	  programs they do not cause
	  <em class="calibre5">bouncing</em> of cache lines.</p><p class="releaseinfo">This situation occurs when a program constantly
	  accesses two areas of memory that map to the same cache
	  line.  This effectively wastes the cache line, as it gets
	  loaded in, used for a short time and then must be kicked out
	  and the other cache line loaded into the same place in the
	  cache.</p><p class="releaseinfo">Obviously if this situation repeats the performance
          will be significantly reduced.  The situation would be
          relieved if the conflicting data was organised in slightly
          different ways to avoid the cache line conflict.</p><p class="releaseinfo">One possible way to detect this sort of situation is
	  <em class="calibre5">profiling</em>.  When you profile your code
	  you "watch" it to analyse what code paths are taken and how
	  long they take to execute.  With <em class="calibre5">profile guided
	  optimisation</em> (PGO) the compiler can put special
	  extra bits of code in the first binary it builds, which runs
	  and makes a record of the branches taken, etc.  You can then
	  recompile the binary with the extra information to possibly
	  create a better performing binary.  Otherwise the programmer
	  can look at the output of the profile and possibly detect
	  situations such as cache line bouncing. (XXX somewhere
	  else?)
	  </p></section><section id="compiling_s3_s1_s3"><header class="calibre8"><h5 class="calibre24"><span class="first-last">3<span class="first-last">.</span>3<span class="first-last">.</span>1<span class="first-last">.</span>3<span class="first-last"> </span></span>Space - Speed Trade off</h5></header><p class="releaseinfo">What the compiler has done above is traded off using
	  some extra memory to gain a speed improvement in running our
	  code.  The compiler knows the rules of the architecture and
	  can make decisions about the best way to align data,
	  possibly by trading off small amounts of wasted memory for
	  increased (or perhaps even just correct) performance.</p><p class="releaseinfo">Consequently as a programmer you should never make
	  assumptions about the way variables and data will be laid
	  out by the compiler.  To do so is not portable, as a
	  different architecture may have different rules and the
	  compiler may make different decisions based on explicit
	  commands or optimisation levels.</p></section><section id="compiling_s3_s1_s4"><header class="calibre8"><h5 class="calibre24"><span class="first-last">3<span class="first-last">.</span>3<span class="first-last">.</span>1<span class="first-last">.</span>4<span class="first-last"> </span></span>Making Assumptions</h5></header><p class="releaseinfo">Thus, as a C programmer you need to be familiar with
	  what you can assume about what the compiler will do and what
	  may be variable.  What exactly you can assume and can not
	  assume is detailed in the C99 standard; if you are
	  programming in C it is certainly worth the investment in
	  becoming familiar with the rules to avoid writing
	  non-portable or buggy code.</p><div id="stack-padding" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="27"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ cat stack.c</code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#include &lt;stdio.h&gt;</code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">struct a_struct {</code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        int a;</code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        int b;</code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">};</code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">int main(void)</code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">{</code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        int i;</code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        struct a_struct s;</code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        printf("%p\n%p\ndiff %ld\n", &amp;i, &amp;s, (unsigned long)&amp;s - (unsigned long)&amp;i);</code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        return 0;</code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">}</code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ gcc-3.3 -Wall -o stack-3.3 ./stack.c</code></span></span>
<span class="line" db-line="17"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ gcc-4.0 -o stack-4.0 stack.c</code></span></span>
<span class="line" db-line="18"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="19"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ ./stack-3.3</code></span></span>
<span class="line" db-line="20"><span class="ln">20 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x60000fffffc2b510</code></span></span>
<span class="line" db-line="21"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x60000fffffc2b520</code></span></span>
<span class="line" db-line="22"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">diff 16</code></span></span>
<span class="line" db-line="23"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="24"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ ./stack-4.0</code></span></span>
<span class="line" db-line="25"><span class="ln">25 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x60000fffff89b520</code></span></span>
<span class="line" db-line="26"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">0x60000fffff89b524</code></span></span>
<span class="line" db-line="27"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">diff 4</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>3<span>.</span>3<span>.</span>1<span>.</span>4<span>.</span>1<span> </span></span>Stack alignment example</div></header></div><p class="releaseinfo">In the example above, taken from an Itanium machine,
	  we can see that the padding and alignment of the stack has
	  changed considerably between <span>gcc</span>
	  versions.  This type of thing is to be expected and must be
	  considered by the programmer.</p><p class="releaseinfo">Generally you should ensure that you do not make
	  assumptions about the size of types or alignment
	  rules.</p></section><section id="compiling_s3_s1_s5"><header class="calibre8"><h5 class="calibre24"><span class="first-last">3<span class="first-last">.</span>3<span class="first-last">.</span>1<span class="first-last">.</span>5<span class="first-last"> </span></span>C Idioms with alignment</h5></header><p class="releaseinfo">There are a few common sequences of code that deal
	  with alignment; generally most programs will consider it in
	  some ways.  You may see these "code idioms" in many places
	  outside the kernel when dealing with programs that deal with
	  chunks of data in some form or another, so it is worth
	  investigating.</p><p class="releaseinfo">We can take some examples from the Linux kernel, which
	  often has to deal with alignment of pages of memory within
	  the system.</p><div id="page-alignment" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="20"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">[ include/asm-ia64/page.h ]</code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/*</code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> * PAGE_SHIFT determines the actual kernel page size.</code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> */</code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#if defined(CONFIG_IA64_PAGE_SIZE_4KB)</code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"># define PAGE_SHIFT     12</code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#elif defined(CONFIG_IA64_PAGE_SIZE_8KB)</code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"># define PAGE_SHIFT     13</code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#elif defined(CONFIG_IA64_PAGE_SIZE_16KB)</code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"># define PAGE_SHIFT     14</code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#elif defined(CONFIG_IA64_PAGE_SIZE_64KB)</code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"># define PAGE_SHIFT     16</code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#else</code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13"># error Unsupported page size!</code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#endif</code></span></span>
<span class="line" db-line="17"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="18"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#define PAGE_SIZE               (__IA64_UL_CONST(1) &lt;&lt; PAGE_SHIFT)</code></span></span>
<span class="line" db-line="19"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#define PAGE_MASK               (~(PAGE_SIZE - 1))</code></span></span>
<span class="line" db-line="20"><span class="ln">20 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#define PAGE_ALIGN(addr)        (((addr) + PAGE_SIZE - 1) &amp; PAGE_MASK)</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>3<span>.</span>3<span>.</span>1<span>.</span>5<span>.</span>1<span> </span></span>Page alignment manipulations</div></header></div><p class="releaseinfo">Above we can see that there are a number of different
	  options for page sizes within the kernel, ranging from 4KB
	  through 64KB.</p><p class="releaseinfo">The <code class="computeroutput1">PAGE_SIZE</code> macro
	  is fairly self explanatory, giving the current page size
	  selected within the system by shifting a value of 1 by the
	  shift number given (remember, this is the equivalent of
	  saying
	  <code class="computeroutput1">2<sup class="calibre23">n</sup></code>
	  where <code class="computeroutput1">n</code> is the
	  <code class="computeroutput1">PAGE_SHIFT</code>).</p><p class="releaseinfo">Next we have a definition for
	  <code class="computeroutput1">PAGE_MASK</code>.  The
	  <code class="computeroutput1">PAGE_MASK</code> allows us to find
	  just those bits that are within the current page, that is
	  the <code class="computeroutput1">offset</code> of an address
	  within its page.</p><p class="releaseinfo">XXX continue short discussion</p></section></section></section><section id="compiling_s4"><header class="calibre8"><h3 class="calibre2"><span class="first-last">3<span class="first-last">.</span>4<span class="first-last"> </span></span>Optimisation</h3></header><p class="releaseinfo">Once the compiler has an internal representation of the
      code, the <em class="calibre5">really</em> interesting part of the
      compiler starts.  The compiler wants to find the most optimised
      assembly language output for the given input code.  This is a
      large and varied problem and requires knowledge of everything
      from efficient algorithms based in computer science to deep
      knowledge about the particular processor the code is to be run
      on.</p><p class="releaseinfo">There are some common optimisations the compiler can look
      at when generating output.  There are many, many more strategies
      for generating the best code, and it is always an active
      research area.</p><section id="compiling_s4_s1"><header class="calibre8"><h4 class="calibre21"><span class="first-last">3<span class="first-last">.</span>4<span class="first-last">.</span>1<span class="first-last"> </span></span>General Optimising</h4></header><p class="releaseinfo">The compiler can often see that a particular piece of
	code can not be used and so leave it out optimise a particular
	language construct into something smaller with the same
	outcome.</p></section><section id="compiling_s4_s2"><header class="calibre8"><h4 class="calibre21"><span class="first-last">3<span class="first-last">.</span>4<span class="first-last">.</span>2<span class="first-last"> </span></span>Unrolling loops</h4></header><p class="releaseinfo">If code contains a loop, such as a
	<code class="computeroutput1">for</code> or
	<code class="computeroutput1">while</code> loop and the compiler
	has some idea how many times it will execute, it may be more
	efficient to <em class="calibre5">unroll</em> the loop so that it
	executes sequentially.  This means that instead of doing the
	inside of the loop and then branching back to the start to do
	repeat the process, the inner loop code is duplicated to be
	executed again.</p><p class="releaseinfo">Whilst this increases the size of the code, it may allow
	the processor to work through the instructions more
	efficiently as branches can cause inefficiencies in the
	pipeline of instructions coming into the processor.</p></section><section id="compiling_s4_s3"><header class="calibre8"><h4 class="calibre21"><span class="first-last">3<span class="first-last">.</span>4<span class="first-last">.</span>3<span class="first-last"> </span></span>Inlining functions</h4></header><p class="releaseinfo">Similar to unrolling loops, it is possible to put embed
	called functions within the callee.  The programmer can
	specify that the compiler should try to do this by specifying
	the function as <code class="computeroutput1">inline</code> in the
	function definition.  Once again, you may trade code size for
	sequentially in the code by doing this.</p></section><section id="compiling_s4_s4"><header class="calibre8"><h4 class="calibre21"><span class="first-last">3<span class="first-last">.</span>4<span class="first-last">.</span>4<span class="first-last"> </span></span>Branch Prediction</h4></header><p class="releaseinfo">Any time the computer comes across an
	<code class="computeroutput1">if</code> statement there are two
	possible outcomes; true or false.  The processor wants to keep
	its incoming pipes as full as possible, so it can not wait for
	the outcome of the test before putting code into the
	pipeline.</p><p class="releaseinfo">Thus the compiler can make a prediction about what way
	the test is likely to go.  There are some simple rules the
	compiler can use to guess things like this, for example
	<code class="computeroutput1">if (val == -1)</code> is probably
	<em class="calibre5">not</em> likely to be true, since -1 usually
	indicates an error code and hopefully that will not be
	triggered too often.</p><p class="releaseinfo">Some compilers can actually compile the program, have
	the user run it and take note of which way the branches go
	under real conditions.  It can then re-compile it based on
	what it has seen.</p></section></section></section></div></main>

<main class="calibre3">
<div id="chapter06" class="author">
<section id="assembler"><header class="calibre8"><h2 class="calibre7" id="calibre_pb_51"><span class="first-last">4<span class="first-last"> </span></span>Assembler</h2></header><p class="releaseinfo">The assembly code outputted by the compiler is still in a
    human readable form, should you know the specifics of the assembly
    code for the processor.  Developers will often take a peek at the
    assembly output to manually check that the code is the most
    optimised or to discover any bugs in the compiler (this is more
    common than one might think, especially when the compiler is
    being very aggressive with optimisations).</p><p class="releaseinfo">The assembler is a more mechanical process of converting the
    assembly code into a binary form.  Essentially, the assembler
    keeps a large table of each possible instruction and its binary
    counterpart (called an <em class="calibre5">op code</em> for operation
    code).  It combines these opcodes with the registers specified in
    the assembly to produce a binary output file.</p><p class="releaseinfo">This code is called <em class="calibre5">object code</em> and, at
    this stage, is not executable.  Object code is simply a binary
    representation of specific input source code file.  Good
    programming practice dictates that a programmer should not "put
    all the eggs in one basket" by placing all your source code in one
    file.</p></section></div></main>

<main class="calibre3">
<div id="chapter06" class="author">
<section id="linker"><header class="calibre8"><h2 class="calibre7" id="calibre_pb_52"><span class="first-last">5<span class="first-last"> </span></span>Linker</h2></header><p class="releaseinfo">Often in a large program, you will separate out code into
      multiple files to keep related functions together.  Each of
      these files can be compiled into object code: but your final
      goal is to create a single executable! There needs to be some
      way combining each of these object files into a single
      executable.  We call this linking.</p><p class="releaseinfo">Note that even if your program does fit in one file it still
    needs to be linked against certain system libraries to operate
    correctly.  For example, the
    <code class="computeroutput1">printf</code> call is kept in a library
    which must be combined with your executable to work.  So although
    you do not explicitly have to worry about linking in this case,
    there is most certainly still a linking process happening to
    create your executable.</p><p class="releaseinfo">In the following sections we explain some terms essential to
    understanding linking.</p><section id="linker_s1"><header class="calibre8"><h3 class="calibre2"><span class="first-last">5<span class="first-last">.</span>1<span class="first-last"> </span></span>Symbols</h3></header><section id="linker_s1_s1"><header class="calibre8"><h4 class="calibre21"><span class="first-last">5<span class="first-last">.</span>1<span class="first-last">.</span>1<span class="first-last"> </span></span>Symbols</h4></header><p class="releaseinfo">Variables and functions all have names in source code
      which we refer to them by.  One way of thinking of a statement
      declaring a variable <code class="computeroutput1">int a</code> is
      that you are telling the compiler "set aside some memory of
      <code class="computeroutput1">sizeof(int)</code> and from now on
      when I use <code class="computeroutput1">a</code> it will refer to
      this allocated memory.  Similarly a function says "store this
      code in memory, and when I call
      <code class="computeroutput1">function()</code> jump to and execute
      this code".
      </p><p class="releaseinfo">In this case, we call <code class="computeroutput1">a</code>
      and <code class="computeroutput1">function</code>
      <em class="calibre5">symbols</em> since they are a symbolic
      representation of an area of memory.</p><p class="releaseinfo">Symbols help humans to understand programming.  You could
      say that the primary job of the compilation process is to remove
      symbols -- the processor doesn't know what
      <code class="computeroutput1">a</code> represents, all it knows is
      that it has some data at a particular memory address.  The
      compilation process needs to convert <code class="computeroutput1">a +=
      2</code> to something like "increment the value in
      memory at <code class="computeroutput1">0xABCDE</code> by 2.</p></section><section id="linker_s1_s2"><header class="calibre8"><h4 class="calibre21"><span class="first-last">5<span class="first-last">.</span>1<span class="first-last">.</span>2<span class="first-last"> </span></span>Symbol Visibility</h4></header><p class="releaseinfo">In some C programs, you may have seen the terms
      <code class="computeroutput1">static</code> and
      <code class="computeroutput1">extern</code> used with variables.
      These modifiers can effect what we call the visibility of
      symbols.</p><p class="releaseinfo">Imagine you have split up your program in two files, but
      some functions need to share a variable.  You only want one
      <em class="calibre5">definition</em> (i.e. memory location) of the
      shared variable (otherwise it wouldn't be shared!), but both
      files need to reference it.</p><p class="releaseinfo">To enable this, we declare the variable in one file, and
      then in the other file declare a variable of the same name but
      with the prefix <code class="computeroutput1">extern</code>.
      <code class="computeroutput1">extern</code> stands for
      <em class="calibre5">external</em> and to a human means that this
      variable is declared somewhere else.</p><p class="releaseinfo">What <code class="computeroutput1">extern</code> says to a
      compiler is that it should not allocate any space in memory for
      this variable, and leave this symbol in the object code where it
      will be fixed up later.  The compiler can not possibly know
      where the symbol is actually defined but the
      <em class="calibre5">linker</em>does, since it is its job to look at
      all object files together and combine them into a single
      executable.  So the linker will see the symbol left over in the
      second file, and say "I've seen that symbol before in file 1,
      and I know that it refers to memory location
      <code class="computeroutput1">0x12345</code>".  Thus it can modify
      the symbol value to be the memory value of the variable in the
      first file.</p><p class="releaseinfo"><code class="computeroutput1">static</code> is almost the
      opposite of <code class="computeroutput1">extern</code>.  It places
      restrictions on the visibility of the symbol it modifies.  If you
      declare a variable with <code class="computeroutput1">static</code>
      that says to the compiler "don't leave any symbols for this in
      the object code".  This means that when the linker is linking
      together object files it will never see that symbol (and so
      can't make that "I've seen this before!" connection).
      <code class="computeroutput1">static</code> is good for separation
      and reducing conflicts -- by declaring a variable
      <code class="computeroutput1">static</code> you can reuse the
      variable name in other files and not end up with symbol clashes.
      We say we are <em class="calibre5">restricting the visibility</em> of
      the symbol, because we are not allowing the linker to see it.
      Contrast this with a more visible symbol (one not declared with
      <code class="computeroutput1">static</code>) which can be seen by
      the linker.</p></section></section><section id="linker_s2"><header class="calibre8"><h3 class="calibre2"><span class="first-last">5<span class="first-last">.</span>2<span class="first-last"> </span></span>The linking process</h3></header><p class="releaseinfo">Thus the linking process is really two steps; combining
      all object files into one executable file and then going through
      each object file to <em class="calibre5">resolve</em> any symbols.
      This usually requires two passes; one to read all the symbol
      definitions and take note of unresolved symbols and a second to
      fix up all those unresolved symbols to the right place.</p><p class="releaseinfo">The final executable should end up with no unresolved
      symbols; the linker will fail with an error if there are
      any.<span id="linker_s2_para2_footnote1-fnote">We call this <em class="calibre5">static
      linking</em>.  Dynamic linking is a similar concept done
      at executable runtime, and is described a little later
      on.</span></p></section></section></div></main>

<main class="calibre3">
<div id="chapter06" class="author">
<section id="compilation_example"><header class="calibre8"><h2 class="calibre7" id="calibre_pb_53"><span class="first-last">6<span class="first-last"> </span></span>A practical example</h2></header><p class="releaseinfo">We can walk through the steps taken to build a simple
    application step by step.</p><p class="releaseinfo">Note that when you type <code class="computeroutput1">gcc</code>
    that actually runs a driver program that hides most of the steps
    from you.  Under normal circumstances this is exactly what you
    want, because the exact commands and options to get a real life
    working executable on a real system can be quite complicated and
    architecture specific.</p><p class="releaseinfo">We will show the compilation process with the two following
    examples.  Both are C source files, one defined the
    <code class="computeroutput1">main()</code> function for the initial
    program entry point, and another declares a helper type function.
    There is one global variable too, just for illustration.</p><div id="c-hello" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="17"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#include &lt;stdio.h&gt;</code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/* We need a prototype so the compiler knows what types function() takes */</code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">int function(char *input);</code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/* Since this is static, we can define it in both hello.c and function.c */</code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">static int i = 100;</code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/* This is a global variable */</code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">int global = 10;</code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">int main(void)</code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">{</code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">	/* function() should return the value of global */</code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">	int ret = function("Hello, World!");</code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">	exit(ret);</code></span></span>
<span class="line" db-line="17"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">}</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>6<span>.</span>1<span> </span></span>Hello World</div></header></div><div id="compilation_example_ex2" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="12"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">#include &lt;stdio.h&gt;</code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">static int i = 100;</code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/* Declard as extern since defined in hello.c */</code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">extern int global;</code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">int function(char *input)</code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">{</code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">	printf("%s\n", input);</code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">	return global;</code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">}</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>6<span>.</span>2<span> </span></span>Function Example</div></header></div><section id="compilation_example_s1"><header class="calibre8"><h3 class="calibre2"><span class="first-last">6<span class="first-last">.</span>1<span class="first-last"> </span></span>Compiling</h3></header><p class="releaseinfo">All compilers have an option to only execute the first
      step of compilation.  Usually this is something like
      <code class="computeroutput1">-S</code> and the output will
      generally be put into a file with the same name as the input
      file but with a <code class="computeroutput1">.s</code>
      extension.</p><p class="releaseinfo">Thus we can show the first step with <code class="computeroutput1">gcc
      -S</code> as illustrated in the example below.</p><div id="compilation_example_s1_ex1" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="54"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ gcc -S hello.c</code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ gcc -S function.c</code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ cat function.s</code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .file   "function.c"</code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .pred.safe_across_calls p1-p5,p16-p63</code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .section        .sdata,"aw",@progbits</code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .align 4</code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .type   i#, @object</code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .size   i#, 4</code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">i:</code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        data4   100</code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .section        .rodata</code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .align 8</code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">.LC0:</code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        stringz "%s\n"</code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .text</code></span></span>
<span class="line" db-line="17"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .align 16</code></span></span>
<span class="line" db-line="18"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .global function#</code></span></span>
<span class="line" db-line="19"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .proc function#</code></span></span>
<span class="line" db-line="20"><span class="ln">20 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">function:</code></span></span>
<span class="line" db-line="21"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .prologue 14, 33</code></span></span>
<span class="line" db-line="22"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .save ar.pfs, r34</code></span></span>
<span class="line" db-line="23"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        alloc r34 = ar.pfs, 1, 4, 2, 0</code></span></span>
<span class="line" db-line="24"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .vframe r35</code></span></span>
<span class="line" db-line="25"><span class="ln">25 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov r35 = r12</code></span></span>
<span class="line" db-line="26"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        adds r12 = -16, r12</code></span></span>
<span class="line" db-line="27"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov r36 = r1</code></span></span>
<span class="line" db-line="28"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .save rp, r33</code></span></span>
<span class="line" db-line="29"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov r33 = b0</code></span></span>
<span class="line" db-line="30"><span class="ln">30 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .body</code></span></span>
<span class="line" db-line="31"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ;;</code></span></span>
<span class="line" db-line="32"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        st8 [r35] = r32</code></span></span>
<span class="line" db-line="33"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        addl r14 = @ltoffx(.LC0), r1</code></span></span>
<span class="line" db-line="34"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ;;</code></span></span>
<span class="line" db-line="35"><span class="ln">35 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ld8.mov r37 = [r14], .LC0</code></span></span>
<span class="line" db-line="36"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ld8 r38 = [r35]</code></span></span>
<span class="line" db-line="37"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        br.call.sptk.many b0 = printf#</code></span></span>
<span class="line" db-line="38"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov r1 = r36</code></span></span>
<span class="line" db-line="39"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ;;</code></span></span>
<span class="line" db-line="40"><span class="ln">40 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        addl r15 = @ltoffx(global#), r1</code></span></span>
<span class="line" db-line="41"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ;;</code></span></span>
<span class="line" db-line="42"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ld8.mov r14 = [r15], global#</code></span></span>
<span class="line" db-line="43"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ;;</code></span></span>
<span class="line" db-line="44"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ld4 r14 = [r14]</code></span></span>
<span class="line" db-line="45"><span class="ln">45 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ;;</code></span></span>
<span class="line" db-line="46"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov r8 = r14</code></span></span>
<span class="line" db-line="47"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov ar.pfs = r34</code></span></span>
<span class="line" db-line="48"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov b0 = r33</code></span></span>
<span class="line" db-line="49"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .restore sp</code></span></span>
<span class="line" db-line="50"><span class="ln">50 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        mov r12 = r35</code></span></span>
<span class="line" db-line="51"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        br.ret.sptk.many b0</code></span></span>
<span class="line" db-line="52"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        ;;</code></span></span>
<span class="line" db-line="53"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .endp function#</code></span></span>
<span class="line" db-line="54"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">        .ident  "GCC: (GNU) 3.3.5 (Debian 1:3.3.5-11)"</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>6<span>.</span>1<span>.</span>1<span> </span></span>Compilation Example</div></header></div><p class="releaseinfo">The assembly is a little to complex to fully describe, but
      you should be able to see where
      <code class="computeroutput1">i</code> is defined as a
      <code class="computeroutput1">data4</code> (i.e. 4 bytes or 32 bits,
      the size of an <code class="computeroutput1">int</code>), where
      <code class="computeroutput1">function</code> is defined
      (<code class="computeroutput1">function:</code>) and a call to
      <code class="computeroutput1">printf()</code>.</p><p class="releaseinfo">We now have two assembly files ready to be assembled into
      machine code!</p></section><section id="compilation_example_s2"><header class="calibre8"><h3 class="calibre2"><span class="first-last">6<span class="first-last">.</span>2<span class="first-last"> </span></span>Assembly</h3></header><p class="releaseinfo">Assembly is a fairly straight forward process.  The
      assembler is usually called <code class="computeroutput1">as</code>
      and takes arguments in a similar fashion to
      <code class="computeroutput1">gcc</code></p><div id="compilation_example_s2_ex1" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="4"><pre class="language-c"><span class="line" db-line="1"><span class="ln">  <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ as -o function.o function.s</code></span></span>
<span class="line" db-line="2"><span class="ln">  <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ as -o hello.o hello.s</code></span></span>
<span class="line" db-line="3"><span class="ln">  <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ ls</code></span></span>
<span class="line" db-line="4"><span class="ln">  <span class="nsep">|</span></span><span class="ld"><code class="calibre13">function.c  function.o  function.s  hello.c  hello.o  hello.s</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>6<span>.</span>2<span>.</span>1<span> </span></span>Assembly Example</div></header></div><p class="releaseinfo">After assembling we have <em class="calibre5">object</em> code,
      which is ready to be linked together into the final executable.
      You can usually skip having to use the assembler by hand by
      calling the compiler with <code class="computeroutput1">-c</code>,
      which will directly convert the input file to object code,
      putting it in a file with the same prefix but
      <code class="computeroutput1">.o</code> as an extension.</p><p class="releaseinfo">We can't inspect the object code directly, as it is in a
      binary format (in future weeks we will learn about this binary
      format).  However we can use some tools to inspect the object
      files, for example <code class="computeroutput1">readelf
      --symbols</code> will show us symbols in the object
      file.</p><div id="compilation_example_s2_ex2" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="38"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ readelf --symbols ./hello.o</code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">Symbol table '.symtab' contains 15 entries:</code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   Num:    Value          Size Type    Bind   Vis      Ndx Name</code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND</code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c</code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1</code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3</code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4</code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5</code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     6: 0000000000000000     4 OBJECT  LOCAL  DEFAULT    5 i</code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    6</code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     8: 0000000000000000     0 SECTION LOCAL  DEFAULT    7</code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     9: 0000000000000000     0 SECTION LOCAL  DEFAULT    8</code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    10: 0000000000000000     0 SECTION LOCAL  DEFAULT   10</code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    11: 0000000000000004     4 OBJECT  GLOBAL DEFAULT    5 global</code></span></span>
<span class="line" db-line="17"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    12: 0000000000000000    96 FUNC    GLOBAL DEFAULT    1 main</code></span></span>
<span class="line" db-line="18"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    13: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND function</code></span></span>
<span class="line" db-line="19"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    14: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND exit</code></span></span>
<span class="line" db-line="20"><span class="ln">20 <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="21"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">$ readelf --symbols ./function.o</code></span></span>
<span class="line" db-line="22"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="23"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">Symbol table '.symtab' contains 14 entries:</code></span></span>
<span class="line" db-line="24"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   Num:    Value          Size Type    Bind   Vis      Ndx Name</code></span></span>
<span class="line" db-line="25"><span class="ln">25 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND</code></span></span>
<span class="line" db-line="26"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS function.c</code></span></span>
<span class="line" db-line="27"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1</code></span></span>
<span class="line" db-line="28"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3</code></span></span>
<span class="line" db-line="29"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4</code></span></span>
<span class="line" db-line="30"><span class="ln">30 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5</code></span></span>
<span class="line" db-line="31"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     6: 0000000000000000     4 OBJECT  LOCAL  DEFAULT    5 i</code></span></span>
<span class="line" db-line="32"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    6</code></span></span>
<span class="line" db-line="33"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     8: 0000000000000000     0 SECTION LOCAL  DEFAULT    7</code></span></span>
<span class="line" db-line="34"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     9: 0000000000000000     0 SECTION LOCAL  DEFAULT    8</code></span></span>
<span class="line" db-line="35"><span class="ln">35 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    10: 0000000000000000     0 SECTION LOCAL  DEFAULT   10</code></span></span>
<span class="line" db-line="36"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    11: 0000000000000000   128 FUNC    GLOBAL DEFAULT    1 function</code></span></span>
<span class="line" db-line="37"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    12: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND printf</code></span></span>
<span class="line" db-line="38"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    13: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND global</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>6<span>.</span>2<span>.</span>2<span> </span></span>Readelf Example</div></header></div><p class="releaseinfo">Although the output is quite complicated (again!) you
      should be able to understand much of it.  For example</p><ul class="itemizedlist"><li class="calibre11"><p class="releaseinfo">In the output of
	  <code class="computeroutput1">hello.o</code> have a look at the
	  symbol with name <code class="computeroutput1">i</code>.  Notice
	  how it says it is <code class="computeroutput1">LOCAL</code>?
	  That is because we declared it
	  <code class="computeroutput1">static</code> and as such it has
	  been flagged as being local to this object file.</p></li><li class="calibre11"><p class="releaseinfo">In the same output, notice that the
	  <code class="computeroutput1">global</code> variable is defined
	  as a <code class="computeroutput1">GLOBAL</code>, meaning that
	  it is visible outside this file.  Similarly the
	  <code class="computeroutput1">main()</code> function is
	  externally visible.
	  </p></li><li class="calibre11"><p class="releaseinfo">Notice that the
	  <code class="computeroutput1">function</code> symbol (for the
	  call to <code class="computeroutput1">function()</code> is left
	  has <code class="computeroutput1">UND</code> or
	  <em class="calibre5">undefined</em>.  This means that it has been
	  left for the linker to find the address of the
	  function.</p></li><li class="calibre11"><p class="releaseinfo">Have a look at the symbols in the
	  <code class="computeroutput1">function.c</code> file and how
	  they fit into the output.</p></li></ul></section><section id="compilation_example_s3"><header class="calibre8"><h3 class="calibre2"><span class="first-last">6<span class="first-last">.</span>3<span class="first-last"> </span></span>Linking</h3></header><p class="releaseinfo">Actually invoking the linker, called
      <code class="computeroutput1">ld</code>, is a very complicated
      process on a real system (are you sick of hearing this yet?).
      This is why we leave the linking process up to
      <code class="computeroutput1">gcc</code>.</p><p class="releaseinfo">But of course we can spy on what
      <code class="computeroutput1">gcc</code> is doing under the hood
      with the <code class="computeroutput1">-v</code> (verbose)
      flag.</p><div id="compilation_example_s3_ex1" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="16"><pre class="language-c"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> /usr/lib/gcc-lib/ia64-linux/3.3.5/collect2 -static </code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/usr/lib/gcc-lib/ia64-linux/3.3.5/../../../crt1.o </code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/usr/lib/gcc-lib/ia64-linux/3.3.5/../../../crti.o </code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/usr/lib/gcc-lib/ia64-linux/3.3.5/crtbegin.o </code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">-L/usr/lib/gcc-lib/ia64-linux/3.3.5 </code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">-L/usr/lib/gcc-lib/ia64-linux/3.3.5/../../.. </code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">hello.o </code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">function.o </code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">--start-group </code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">-lgcc </code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">-lgcc_eh </code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">-lunwind </code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">-lc </code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">--end-group </code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/usr/lib/gcc-lib/ia64-linux/3.3.5/crtend.o </code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code class="calibre13">/usr/lib/gcc-lib/ia64-linux/3.3.5/../../../crtn.o</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>6<span>.</span>3<span>.</span>1<span> </span></span>Linking Example</div></header></div><p class="releaseinfo">The first thing you notice is that a program called
      <span>collect2</span> is being called.  This is a
      simple wrapper around <span>ld</span> that
      is used internally by <span>gcc</span>.</p><p class="releaseinfo">The next thing you notice is object files starting with
      <code class="computeroutput1">crt</code> being specified to the
      linker.  These functions are provided by gcc and the system
      libraries and contain code required to start the program.  In
      actuality, the <code class="computeroutput1">main()</code> function
      is not the first one called when a program runs, but a function
      called <code class="computeroutput1">_start</code> which is in the
      <code class="computeroutput1">crt</code> object files.  This
      function does some generic setup which application programmers
      do not need to worry about.</p><p class="releaseinfo">The path hierarchy is quite complicated, but in
	  essence we can see that the final step is to link in some
	  extra object files, namely </p><ul class="itemizedlist"><li class="calibre11"><p class="releaseinfo"><code class="computeroutput1">crt1.o</code> : provided
	      by the system libraries (libc) this object file contains
	      the <code class="computeroutput1">_start</code> function
	      which is actually the first thing called within the program.</p><p class="releaseinfo"><code class="computeroutput1">crti.o</code> : provided
	      by the system libraries</p><p class="releaseinfo">
            <code class="computeroutput1">crtbegin.o</code>
          </p><p class="releaseinfo">
            <code class="computeroutput1">crtsaveres.o</code>
          </p><p class="releaseinfo">
            <code class="computeroutput1">crtend.o</code>
          </p><p class="releaseinfo">
            <code class="computeroutput1">crtn.o</code>
          </p></li></ul><p class="releaseinfo">We discuss how these are used to start the program a
	little later.</p><p class="releaseinfo">Next you can see that we link in our two object files,
      <code class="computeroutput1">hello.o</code> and
      <code class="computeroutput1">function.o</code>.  After that we
      specify some extra libraries with
      <code class="computeroutput1">-l</code> flags.  These libraries are
      system specific and required for every program.  The major one
      is <code class="computeroutput1">-lc</code> which brings in the C
      library, which has all common functions like
      <code class="computeroutput1">printf()</code>.</p><p class="releaseinfo">After that we again link in some more system object files
      which do some cleanup after programs exit.</p><p class="releaseinfo">Although the details are complicated, the concept is
      straight forward.  All the object files will be linked together
      into a single executable file, ready to run!</p></section><section id="compilation_example_s4"><header class="calibre8"><h3 class="calibre2"><span class="first-last">6<span class="first-last">.</span>4<span class="first-last"> </span></span>The Executable</h3></header><p class="releaseinfo">We will go into more details about the executable in the
      short future, but we can do some inspection in a similar fashion
      to the object files to see what has happened.</p><div id="compilation_example_s4_ex1" class="figure"><div class="pre-wrap" db-startinglinenumber="1" db-numberoflines="145"><pre class="language-c"><span class="line" db-line="1"><span class="ln">  1 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">ianw@lime:~/programs/csbu/wk7/code$ gcc -o program hello.c function.c</code></span></span>
<span class="line" db-line="2"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">ianw@lime:~/programs/csbu/wk7/code$ readelf --symbols ./program</code></span></span>
<span class="line" db-line="3"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="4"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">Symbol table '.dynsym' contains 11 entries:</code></span></span>
<span class="line" db-line="5"><span class="ln">  5 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   Num:    Value          Size Type    Bind   Vis      Ndx Name</code></span></span>
<span class="line" db-line="6"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND</code></span></span>
<span class="line" db-line="7"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     1: 6000000000000de0     0 OBJECT  GLOBAL DEFAULT  ABS _DYNAMIC</code></span></span>
<span class="line" db-line="8"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     2: 0000000000000000   176 FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.2 (2)</code></span></span>
<span class="line" db-line="9"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     3: 600000000000109c     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start</code></span></span>
<span class="line" db-line="10"><span class="ln"> 10 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     4: 0000000000000000   704 FUNC    GLOBAL DEFAULT  UND exit@GLIBC_2.2 (2)</code></span></span>
<span class="line" db-line="11"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     5: 600000000000109c     0 NOTYPE  GLOBAL DEFAULT  ABS _edata</code></span></span>
<span class="line" db-line="12"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     6: 6000000000000fe8     0 OBJECT  GLOBAL DEFAULT  ABS _GLOBAL_OFFSET_TABLE_     7: 60000000000010b0     0 NOTYPE  GLOBAL DEFAULT  ABS _end</code></span></span>
<span class="line" db-line="13"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     8: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses</code></span></span>
<span class="line" db-line="14"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     9: 0000000000000000   544 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2 (2)</code></span></span>
<span class="line" db-line="15"><span class="ln"> 15 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    10: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__</code></span></span>
<span class="line" db-line="16"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13"> </code></span></span>
<span class="line" db-line="17"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">Symbol table '.symtab' contains 127 entries:</code></span></span>
<span class="line" db-line="18"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   Num:    Value          Size Type    Bind   Vis      Ndx Name</code></span></span>
<span class="line" db-line="19"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND</code></span></span>
<span class="line" db-line="20"><span class="ln"> 20 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     1: 40000000000001c8     0 SECTION LOCAL  DEFAULT    1</code></span></span>
<span class="line" db-line="21"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     2: 40000000000001e0     0 SECTION LOCAL  DEFAULT    2</code></span></span>
<span class="line" db-line="22"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     3: 4000000000000200     0 SECTION LOCAL  DEFAULT    3</code></span></span>
<span class="line" db-line="23"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     4: 4000000000000240     0 SECTION LOCAL  DEFAULT    4</code></span></span>
<span class="line" db-line="24"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     5: 4000000000000348     0 SECTION LOCAL  DEFAULT    5</code></span></span>
<span class="line" db-line="25"><span class="ln"> 25 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     6: 40000000000003d8     0 SECTION LOCAL  DEFAULT    6</code></span></span>
<span class="line" db-line="26"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     7: 40000000000003f0     0 SECTION LOCAL  DEFAULT    7</code></span></span>
<span class="line" db-line="27"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     8: 4000000000000410     0 SECTION LOCAL  DEFAULT    8</code></span></span>
<span class="line" db-line="28"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">     9: 4000000000000440     0 SECTION LOCAL  DEFAULT    9</code></span></span>
<span class="line" db-line="29"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    10: 40000000000004a0     0 SECTION LOCAL  DEFAULT   10</code></span></span>
<span class="line" db-line="30"><span class="ln"> 30 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    11: 40000000000004e0     0 SECTION LOCAL  DEFAULT   11</code></span></span>
<span class="line" db-line="31"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    12: 40000000000005e0     0 SECTION LOCAL  DEFAULT   12</code></span></span>
<span class="line" db-line="32"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    13: 4000000000000b00     0 SECTION LOCAL  DEFAULT   13</code></span></span>
<span class="line" db-line="33"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    14: 4000000000000b40     0 SECTION LOCAL  DEFAULT   14</code></span></span>
<span class="line" db-line="34"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    15: 4000000000000b60     0 SECTION LOCAL  DEFAULT   15</code></span></span>
<span class="line" db-line="35"><span class="ln"> 35 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    16: 4000000000000bd0     0 SECTION LOCAL  DEFAULT   16</code></span></span>
<span class="line" db-line="36"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    17: 4000000000000ce0     0 SECTION LOCAL  DEFAULT   17</code></span></span>
<span class="line" db-line="37"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    18: 6000000000000db8     0 SECTION LOCAL  DEFAULT   18</code></span></span>
<span class="line" db-line="38"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    19: 6000000000000dd0     0 SECTION LOCAL  DEFAULT   19</code></span></span>
<span class="line" db-line="39"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    20: 6000000000000dd8     0 SECTION LOCAL  DEFAULT   20</code></span></span>
<span class="line" db-line="40"><span class="ln"> 40 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    21: 6000000000000de0     0 SECTION LOCAL  DEFAULT   21</code></span></span>
<span class="line" db-line="41"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    22: 6000000000000fc0     0 SECTION LOCAL  DEFAULT   22</code></span></span>
<span class="line" db-line="42"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    23: 6000000000000fd0     0 SECTION LOCAL  DEFAULT   23</code></span></span>
<span class="line" db-line="43"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    24: 6000000000000fe0     0 SECTION LOCAL  DEFAULT   24</code></span></span>
<span class="line" db-line="44"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    25: 6000000000000fe8     0 SECTION LOCAL  DEFAULT   25</code></span></span>
<span class="line" db-line="45"><span class="ln"> 45 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    26: 6000000000001040     0 SECTION LOCAL  DEFAULT   26</code></span></span>
<span class="line" db-line="46"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    27: 6000000000001080     0 SECTION LOCAL  DEFAULT   27</code></span></span>
<span class="line" db-line="47"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    28: 60000000000010a0     0 SECTION LOCAL  DEFAULT   28</code></span></span>
<span class="line" db-line="48"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    29: 60000000000010a8     0 SECTION LOCAL  DEFAULT   29</code></span></span>
<span class="line" db-line="49"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    30: 0000000000000000     0 SECTION LOCAL  DEFAULT   30</code></span></span>
<span class="line" db-line="50"><span class="ln"> 50 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    31: 0000000000000000     0 SECTION LOCAL  DEFAULT   31</code></span></span>
<span class="line" db-line="51"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    32: 0000000000000000     0 SECTION LOCAL  DEFAULT   32</code></span></span>
<span class="line" db-line="52"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    33: 0000000000000000     0 SECTION LOCAL  DEFAULT   33</code></span></span>
<span class="line" db-line="53"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    34: 0000000000000000     0 SECTION LOCAL  DEFAULT   34</code></span></span>
<span class="line" db-line="54"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    35: 0000000000000000     0 SECTION LOCAL  DEFAULT   35</code></span></span>
<span class="line" db-line="55"><span class="ln"> 55 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    36: 0000000000000000     0 SECTION LOCAL  DEFAULT   36</code></span></span>
<span class="line" db-line="56"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    37: 0000000000000000     0 SECTION LOCAL  DEFAULT   37</code></span></span>
<span class="line" db-line="57"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    38: 0000000000000000     0 SECTION LOCAL  DEFAULT   38</code></span></span>
<span class="line" db-line="58"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    39: 0000000000000000     0 SECTION LOCAL  DEFAULT   39</code></span></span>
<span class="line" db-line="59"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    40: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="60"><span class="ln"> 60 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    41: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="61"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    42: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="62"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    43: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="63"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    44: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="64"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    45: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="65"><span class="ln"> 65 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    46: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="66"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    47: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="67"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    48: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="68"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    49: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;built-in&gt;</code></span></span>
<span class="line" db-line="69"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    50: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS abi-note.S</code></span></span>
<span class="line" db-line="70"><span class="ln"> 70 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    51: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="71"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    52: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS abi-note.S</code></span></span>
<span class="line" db-line="72"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    53: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="73"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    54: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS abi-note.S</code></span></span>
<span class="line" db-line="74"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    55: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="75"><span class="ln"> 75 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    56: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="76"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    57: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="77"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    58: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;built-in&gt;</code></span></span>
<span class="line" db-line="78"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    59: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS abi-note.S</code></span></span>
<span class="line" db-line="79"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    60: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS init.c</code></span></span>
<span class="line" db-line="80"><span class="ln"> 80 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    61: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="81"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    62: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="82"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    63: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS initfini.c</code></span></span>
<span class="line" db-line="83"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    64: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="84"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    65: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="85"><span class="ln"> 85 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    66: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="86"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    67: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="87"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    68: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;built-in&gt;</code></span></span>
<span class="line" db-line="88"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    69: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="89"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    70: 4000000000000670   128 FUNC    LOCAL  DEFAULT   12 gmon_initializer</code></span></span>
<span class="line" db-line="90"><span class="ln"> 90 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    71: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="91"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    72: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="92"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    73: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS initfini.c</code></span></span>
<span class="line" db-line="93"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    74: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="94"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    75: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="95"><span class="ln"> 95 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    76: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="96"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    77: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="97"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    78: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;built-in&gt;</code></span></span>
<span class="line" db-line="98"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    79: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS /build/buildd/glibc-2.3.2</code></span></span>
<span class="line" db-line="99"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    80: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS auto-host.h</code></span></span>
<span class="line" db-line="100"><span class="ln">100 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    81: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="101"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    82: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;built-in&gt;</code></span></span>
<span class="line" db-line="102"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    83: 6000000000000fc0     0 NOTYPE  LOCAL  DEFAULT   22 __CTOR_LIST__</code></span></span>
<span class="line" db-line="103"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    84: 6000000000000fd0     0 NOTYPE  LOCAL  DEFAULT   23 __DTOR_LIST__</code></span></span>
<span class="line" db-line="104"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    85: 6000000000000fe0     0 NOTYPE  LOCAL  DEFAULT   24 __JCR_LIST__</code></span></span>
<span class="line" db-line="105"><span class="ln">105 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    86: 6000000000001088     8 OBJECT  LOCAL  DEFAULT   27 dtor_ptr</code></span></span>
<span class="line" db-line="106"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    87: 40000000000006f0   128 FUNC    LOCAL  DEFAULT   12 __do_global_dtors_aux    </code></span></span>
<span class="line" db-line="107"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    88: 4000000000000770   128 FUNC    LOCAL  DEFAULT   12 __do_jv_register_classes</code></span></span>
<span class="line" db-line="108"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    89: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c</code></span></span>
<span class="line" db-line="109"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    90: 6000000000001090     4 OBJECT  LOCAL  DEFAULT   27 i</code></span></span>
<span class="line" db-line="110"><span class="ln">110 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    91: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS function.c</code></span></span>
<span class="line" db-line="111"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    92: 6000000000001098     4 OBJECT  LOCAL  DEFAULT   27 i</code></span></span>
<span class="line" db-line="112"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    93: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS auto-host.h</code></span></span>
<span class="line" db-line="113"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    94: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;command line&gt;</code></span></span>
<span class="line" db-line="114"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    95: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS &lt;built-in&gt;</code></span></span>
<span class="line" db-line="115"><span class="ln">115 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    96: 6000000000000fc8     0 NOTYPE  LOCAL  DEFAULT   22 __CTOR_END__</code></span></span>
<span class="line" db-line="116"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    97: 6000000000000fd8     0 NOTYPE  LOCAL  DEFAULT   23 __DTOR_END__</code></span></span>
<span class="line" db-line="117"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    98: 6000000000000fe0     0 NOTYPE  LOCAL  DEFAULT   24 __JCR_END__</code></span></span>
<span class="line" db-line="118"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">    99: 6000000000000de0     0 OBJECT  GLOBAL DEFAULT  ABS _DYNAMIC</code></span></span>
<span class="line" db-line="119"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   100: 4000000000000a70   144 FUNC    GLOBAL HIDDEN   12 __do_global_ctors_aux</code></span></span>
<span class="line" db-line="120"><span class="ln">120 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   101: 6000000000000dd8     0 NOTYPE  GLOBAL DEFAULT  ABS __fini_array_end</code></span></span>
<span class="line" db-line="121"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   102: 60000000000010a8     8 OBJECT  GLOBAL HIDDEN   29 __dso_handle</code></span></span>
<span class="line" db-line="122"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   103: 40000000000009a0   208 FUNC    GLOBAL DEFAULT   12 __libc_csu_fini</code></span></span>
<span class="line" db-line="123"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   104: 0000000000000000   176 FUNC    GLOBAL DEFAULT  UND printf@@GLIBC_2.2</code></span></span>
<span class="line" db-line="124"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   105: 40000000000004a0    32 FUNC    GLOBAL DEFAULT   10 _init</code></span></span>
<span class="line" db-line="125"><span class="ln">125 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   106: 4000000000000850   128 FUNC    GLOBAL DEFAULT   12 function</code></span></span>
<span class="line" db-line="126"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   107: 40000000000005e0   144 FUNC    GLOBAL DEFAULT   12 _start</code></span></span>
<span class="line" db-line="127"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   108: 6000000000001094     4 OBJECT  GLOBAL DEFAULT   27 global</code></span></span>
<span class="line" db-line="128"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   109: 6000000000000dd0     0 NOTYPE  GLOBAL DEFAULT  ABS __fini_array_start</code></span></span>
<span class="line" db-line="129"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   110: 40000000000008d0   208 FUNC    GLOBAL DEFAULT   12 __libc_csu_init</code></span></span>
<span class="line" db-line="130"><span class="ln">130 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   111: 600000000000109c     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start</code></span></span>
<span class="line" db-line="131"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   112: 40000000000007f0    96 FUNC    GLOBAL DEFAULT   12 main</code></span></span>
<span class="line" db-line="132"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   113: 6000000000000dd0     0 NOTYPE  GLOBAL DEFAULT  ABS __init_array_end</code></span></span>
<span class="line" db-line="133"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   114: 6000000000000dd8     0 NOTYPE  WEAK   DEFAULT   20 data_start</code></span></span>
<span class="line" db-line="134"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   115: 4000000000000b00    32 FUNC    GLOBAL DEFAULT   13 _fini</code></span></span>
<span class="line" db-line="135"><span class="ln">135 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   116: 0000000000000000   704 FUNC    GLOBAL DEFAULT  UND exit@@GLIBC_2.2</code></span></span>
<span class="line" db-line="136"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   117: 600000000000109c     0 NOTYPE  GLOBAL DEFAULT  ABS _edata</code></span></span>
<span class="line" db-line="137"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   118: 6000000000000fe8     0 OBJECT  GLOBAL DEFAULT  ABS _GLOBAL_OFFSET_TABLE_   </code></span></span>
<span class="line" db-line="138"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   119: 60000000000010b0     0 NOTYPE  GLOBAL DEFAULT  ABS _end</code></span></span>
<span class="line" db-line="139"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   120: 6000000000000db8     0 NOTYPE  GLOBAL DEFAULT  ABS __init_array_start</code></span></span>
<span class="line" db-line="140"><span class="ln">140 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   121: 6000000000001080     4 OBJECT  GLOBAL DEFAULT   27 _IO_stdin_used</code></span></span>
<span class="line" db-line="141"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   122: 60000000000010a0     8 OBJECT  GLOBAL DEFAULT   28 __libc_ia64_register_back</code></span></span>
<span class="line" db-line="142"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   123: 6000000000000dd8     0 NOTYPE  GLOBAL DEFAULT   20 __data_start</code></span></span>
<span class="line" db-line="143"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   124: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses</code></span></span>
<span class="line" db-line="144"><span class="ln">    <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   125: 0000000000000000   544 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_</code></span></span>
<span class="line" db-line="145"><span class="ln">145 <span class="nsep">|</span></span><span class="ld"><code class="calibre13">   126: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__</code></span></span>
</pre></div><header class="calibre8"><div class="title"><span>Example<span> </span></span><span>6<span>.</span>4<span>.</span>1<span> </span></span>Executable Example</div></header></div><p class="releaseinfo">Some things to note</p><ul class="itemizedlist"><li class="calibre11"><p class="releaseinfo">Note I built the executable the "easy" way!</p></li><li class="calibre11"><p class="releaseinfo">See there are two symbol tables; the
	  <code class="computeroutput1">dynsym</code> and
	  <code class="computeroutput1">symtab</code> ones.  We explain
	  how the <code class="computeroutput1">dynsym</code> symbols work
	  soon, but notice that some of them are
	  <em class="calibre5">versioned</em> with an
	  <code class="computeroutput1">@</code> symbol.</p></li><li class="calibre11"><p class="releaseinfo">Note the many symbols that have been included from the
	  extra object files.  Many of them start with
	  <code class="computeroutput1">__</code> to avoid clashing with
	  any names the programmer might choose.  Read through and
	  pick out the symbols we mentioned before from the object
	  files and see if they have changed in any way.</p></li></ul></section></section></div><div id="chapter07" class="author"><header class="calibre6"><div class="calibre10" id="calibre_pb_54"/>
</header></div></main></body></html>