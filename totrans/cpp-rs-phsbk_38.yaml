- en: Multiple return values
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多重返回值
- en: 原文：[https://cel.cs.brown.edu/crp/idioms/out_params/multiple_return.html](https://cel.cs.brown.edu/crp/idioms/out_params/multiple_return.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '[https://cel.cs.brown.edu/crp/idioms/out_params/multiple_return.html](https://cel.cs.brown.edu/crp/idioms/out_params/multiple_return.html)'
- en: One idiom for returning multiple values from a function or method in C++ is
    to pass in references to which the values can be assigned.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: C++中从函数或方法返回多个值的一个习语是传递引用，值可以赋给这些引用。
- en: 'There are several reasons why this idiom might be used:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这种习语的原因有几个：
- en: compatibility with versions of C++ earlier than C++11,
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与C++11之前版本的兼容性，
- en: working in a codebase that uses C-style of C++, or
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在使用C++风格的C++代码库中工作，或者
- en: performance concerns.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 性能问题。
- en: The idiomatic translation of this program into Rust makes use of either [tuples](https://doc.rust-lang.org/std/primitive.tuple.html)
    or a named structure for the return type.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 将此程序翻译成Rust的惯用风格，使用了[元组](https://doc.rust-lang.org/std/primitive.tuple.html)或命名结构作为返回类型。
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: fn get_point() -> (i32, i32) {
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: fn get_point() -> (i32, i32) {
- en: (5, 6)
  id: totrans-11
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: (5, 6)
- en: '}'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '}'
- en: fn main() {
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: fn main() {
- en: let (x, y) = get_point();
  id: totrans-14
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: let (x, y) = get_point();
- en: // ...
  id: totrans-15
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: // ...
- en: '}'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '}'
- en: '[PRE2]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Rust has a dedicated tuple syntax and supports pattern matching with `let` bindings
    in part to support use cases like this one.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Rust有一个专门的元组语法，并支持使用`let`绑定进行模式匹配，部分是为了支持此类用例。
- en: '[Problems with the direct transliteration](#problems-with-the-direct-transliteration)'
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '[直接翻译的问题](#problems-with-the-direct-transliteration)'
- en: It is possible to transliterate the original example that uses out parameters
    to Rust, but Rust requires the initialization of the variables before they can
    be passed to a function. The resulting program is not idiomatic Rust.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 将使用输出参数的原例翻译成Rust是可能的，但Rust要求在将变量传递给函数之前初始化它们。生成的程序不是Rust的惯用风格。
- en: '[PRE3]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: // NOT IDIOMATIC RUST
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: // NOT IDIOMATIC RUST
- en: 'fn get_point(x: &mut i32, y: &mut i32) {'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 'fn get_point(x: &mut i32, y: &mut i32) {'
- en: '*x = 5;'
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*x = 5;'
- en: '*y = 6;'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*y = 6;'
- en: '}'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '}'
- en: fn main() {
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: fn main() {
- en: let mut x = 0; // initialized to arbitrary values
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: let mut x = 0; // 初始化为任意值
- en: let mut y = 0;
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: let mut y = 0;
- en: get_point(&mut x, &mut y);
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: get_point(&mut x, &mut y);
- en: // ...
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: // ...
- en: '}'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '}'
- en: '[PRE4]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This approach requires assigning arbitrary initial values to the variables and
    making the variables mutable, both of which make it harder for the compiler to
    help with avoiding programming errors.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法需要为变量分配任意初始值，并使变量可变，这两者都使得编译器更难帮助避免编程错误。
- en: Additionally, the Rust compiler is tuned for optimizing the idiomatic version
    of the program, and produces a significantly faster binary for that version.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，Rust编译器针对优化程序的惯用版本进行了调整，并为该版本生成显著更快的二进制文件。
- en: In situations where the performance of memory allocation is a concern (such
    as when it is necessary to reuse entire buffers in memory), the trade-offs may
    be different. That situation is discussed in the chapter on [pre-allocated buffers](./pre-allocated_buffers.html).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在内存分配性能是关注点的情况下（例如，当需要内存中重用整个缓冲区时），权衡可能不同。这种情况在关于[预分配缓冲区](./pre-allocated_buffers.html)的章节中进行了讨论。
- en: '[Similarities with idiomatic C++ since C++11](#similarities-with-idiomatic-c-since-c11)'
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '[与C++11及以后惯用C++的相似性](#similarities-with-idiomatic-c-since-c11)'
- en: In C++11 and later, `std::pair` and `std::tuple` are available for returning
    multiple values instead of assigning to reference parameters.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在C++11及以后的版本中，`std::pair`和`std::tuple`可用于返回多个值，而不是将值赋给引用参数。
- en: '[PRE5]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This more closely aligns with the normal Rust idiom for returning multiple values.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 这更符合Rust返回多个值的正常惯用风格。
- en: <link rel="stylesheet" type="text/css" href="../../quiz/style.css"> [Click here
    to leave us feedback about this page.](https://docs.google.com/forms/d/e/1FAIpQLScoygeNlygODY2owQ-HvU8VGx3hi50aic7ZlKCyhJ0VktjiCg/viewform?usp=pp_url&entry.1450251950=Multiple
    return values)
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" type="text/css" href="../../quiz/style.css"> [点击此处为此页提供反馈](https://docs.google.com/forms/d/e/1FAIpQLScoygeNlygODY2owQ-HvU8VGx3hi50aic7ZlKCyhJ0VktjiCg/viewform?usp=pp_url&entry.1450251950=Multiple
    return values)
