# 关于本书

# 关于这本书

本书是并发和多线程机制指导书籍(基于 C++11 标准)。从最基本的`std::thread std::mutex`和`std::async`的使用，到复杂的原子操作和内存模型。

## 路线图

前 4 章，介绍了标准库提供的各种库工具，展示了使用方法。

第五章，涵盖了底层内存模型和原子操作的实际情况，包括原子操作如何对执行顺序进行限制(这章标志着介绍部分的结束)。

第 6、7 章，开始讨论进阶级主题，如何使用基本工具去构建复杂的数据结构——第六章是基于锁的数据结构，第七章是无锁数据结构。

第八章，对设计多线程代码给了一些指导意见，覆盖了性能问题和并行算法。

第九章，线程管理——线程池，工作队列和中断操作。

第十章，测试和调试——bug 类型，定位 Bug 的技巧，以及如何进行测试等等。

附录，包括新的语言特性的简要描述，主要是与多线程相关的特性，以及在第四章中提到的消息传递库的实现细节和 C++11 线程库的完整的参考。

## 谁应该读这本书

如果你正在用 C++写一个多线程程序，你应该阅读本书。如果你正在使用 C++标准库中新的多线程工具，你可以从本书中得到一些指导意见。如果你正在使用其他线程库，后面章节里的建议和技术指导也很值得一看。

阅读本书的前提是，你已经有了一个较好的 C++基础知识；虽然，关于多线程编程的知识或者经验是不必须的，不过这些经验可能有用。

### 如何使用这本书

如果从来没有写过多线程代码，我建议你从头到尾阅读本书；不过，可以跳过第五章中的较为细节的部分。第七章内容依赖于第五章中的内容，因此，如果跳过了第五章，应该保证在读第七章时，已经读过第五章。

如果没有用过 C++11 的工具，为了跟上这本书的进度，可以先阅读一下附录。新工具的使用在文本中已经标注出来，不过，当遇到一些没见过的工具时，可以随时回看附录。

即使有不同环境下写多线程代码的经验，开始的章节仍有必要浏览一下，这样就能清楚的知道，你所熟知的工具在新的 C++标准中对应了哪些工具。如果使用原子变量去做一些底层工作，第五章必须阅读。第八章，有关 C++多线程的异常和安全性内容很值得一看。如果你对某些关键词比较感兴趣，索引和目录能够帮你快速找到相关的内容。

你可能喜欢回顾主要的章节，并使用一个自己的方式阅读示例代码。虽然你已经了解 C++线程库，但附录 D 还是很有用。例如，查找每个类和函数的细节。

## 代码公约和下载

为了区分普通文本，列表中的所有代码和文本中的像这样固定宽度的字体。代码注释伴随着许多列表，重要概念高亮显示。在某些情况下，你可以通过页下给出的快捷链接进行查阅。

本书所有实例的源代码，可在出版商的网站上进行下载：www.manning.com/cplusplusconcurrencyinaction。

### 软件需求

使用书中的代码，可能需要一个较新的 C++编译器(要支持 C++11 语言的特性(见附录 A))，还需要 C++支持标准线程库。

写本书的时候，g++是唯一实现标准线程库的编译器(尽管 Microsoft Visual Studio 2011 preview 中也有实现)。g++4.3 发布时添加了线程库，并且在随后的发布版本中进行扩展。g++4.3 也支持部分 C++11 语言特性，更多特性的支持在后续发布版本中也有添加。更多细节请参考 g++ C++11 的状态页面[1]。

Microsoft Visual Studio 2010 支持部分 C++11 特性，例如：右值引用和 lambda 函数，但是没有实现线程库。

我的公司 Software Solutions Ltd，销售 C++11 标准线程库的完整实现，其可以使用在 Microsoft Visual Studio 2005, Microsoft Visual Studio 2008, Microsoft Visual Studio 2010，以及各种 g++版本上[2]。这个线程库也可以用来测试本书中的例子。

Boost 线程库[3]提供的 API，以及可移植到多个平台。本书中的大多数例子将`std::`替换为`boost::`，再`#include`引用适当的头文件，就能使用 Boost 线程库来运行。还有部分工具还不支持(例如`std::async`)或在 Boost 线程库中有着不同名字(例如：`boost::unique_future`)。

## 作者在线

购买*C++ Concurrency in Action*就能访问曼宁(*Manning Publications*)的私人网络论坛，在那里可以对本书做一些评论，问一些技术问题，获得作者或其他读者的帮助。为了能够访问论坛和订阅，在浏览器地址中输入 www.manning.com/CPlusPlusConcurrencyinAction 后，页面将告诉你如何注册之后访问论坛，你能获得什么样的帮助，还有论坛中的一些规则。

曼宁保证为本书的读者提供互相交流，以及和作者交流的场所。虽然曼宁自愿维护本书的论坛，但不保证这样的场所不会收取任何的费用。所以，建议你可以尝试提一些有挑战性的问题给作者，免得这样的地方白白浪费。

在本书印刷时，就可以通过 Internet 访问作者的在线论坛和之前讨论的文字记录。

* * *

【1】GNU Compiler Collection C++0x/C++11 status page, [`gcc.gnu.org/projects/cxx0x.html`](http://gcc.gnu.org/projects/cxx0x.html).

【2】The `just::thread` implementation of the C++ Standard Thread Library, [`www.stdthread.co.uk`](http://www.stdthread.co.uk).

【3】The Boost C++ library collection, [`www.boost.org`](http://www.boost.org).