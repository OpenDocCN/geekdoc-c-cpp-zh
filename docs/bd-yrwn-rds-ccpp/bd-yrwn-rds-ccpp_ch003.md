# 02\. 套接字简介

本章是关于套接字编程的介绍。假设读者具备计算机网络的基本知识，但没有网络编程经验。本书不包含使用套接字 API 的所有细节，建议你在学习本书的同时阅读手册页和其他网络编程指南。（[`beej.us/`](https://beej.us/) 是学习套接字 API 的好资源。）

Redis 是服务器/客户端系统的例子。多个客户端连接到单个服务器，服务器从 TCP 连接接收请求并返回响应。在我们开始套接字编程之前，需要学习几个 Linux 系统调用。

`socket()` 系统调用返回一个文件描述符。如果你不熟悉 Unix 系统，以下是对“文件描述符”的简要解释：文件描述符是一个整数，它指向 Linux 内核中的某个东西，比如 TCP 连接、磁盘文件、监听端口或其他资源等。

`bind()` 和 `listen()` 系统调用：`bind()` 将一个地址关联到套接字文件描述符，而 `listen()` 允许我们接受对该地址的连接。

`accept()` 接受一个监听文件描述符，当客户端连接到监听地址时，`accept()` 返回一个表示连接套接字的文件描述符。以下是解释服务器典型工作流程的伪代码：

```cpp
fd = socket()
bind(fd, address)
listen(fd)
while True:
    conn_fd = accept(fd)
    do_something_with(conn_fd)
    close(conn_fd)
```

`read()` 系统调用从 TCP 连接接收数据。`write()` 系统调用发送数据。`close()` 系统调用销毁由文件描述符引用的资源，并回收文件描述符编号。

我们介绍了服务器端网络编程所需的系统调用。对于客户端，`connect()` 系统调用接受一个套接字文件描述符和地址，并连接到该地址。以下是客户端的伪代码：

```cpp
fd = socket()
connect(fd, address)
do_something_with(fd)
close(fd)
```

下一章将帮助你开始使用真实代码。
