# 第一章 走近 Qt

# 第一章 走近 Qt

**本章重点**

*   了解 Qt 的起源和功用
*   了解 Qt 产品线以及对应的平台
*   了解 Qt 开发工具的组成和功用
*   掌握 Qt 的授权区分、服务支持
*   掌握 Qt4.5 版的最新内容

# 1.1 Qt 简介

## 1.1 Qt 简介

首先让我们看看业界对于 Qt 的评论：

“Qt 将帮助我们为用户提供空前‘诱人’的应用程序。诺基亚对跨平台 Qt 库和 Linux 平台的一贯投入，是免费软件桌面和移动设备堆栈创新的主要驱动力。 ”

Mark Shuttleworth， Ubuntu 项目创始人

“Qt 是极具创新的和实用的技术。包含了 QtWebKit 的 Qt 提供了一个强大的，跨平 台的网络体验，确保了我们的 3D 环境所具备的身临其境的感觉。我们渴望将 QtWebkit 纳 入到‘Second Life‘中，从而提高在 Web 上的虚拟世界的集成度。”

Linden LabJoe Miller，

Linden 实验室平台与技术开发部副总裁 看起来，Qt 是如此的吸引人，那么就让我带您走进 Qt 的世界吧。

1.关于 Qt

Qt 是一个已经形成事实上的标准 的 C++ 框架，它被用于高性能的跨平台软件开发。 除了拥有扩展的 C++类库以外，Qt 还提供了许多可用来直接快速编写应用程序的工具。此 外，Qt 还具有跨平台能力并能提供国际化支持，这一切确保了 Qt 应用程序的市场应用范 围极为广泛。

自 1995 年以来，Qt 逐步进入商业领域，它已经成为全世界范围内数千种成功的应用 程序的基础。Qt C++ 框架一直是商业应用程序的核心。无论是跨国公司和大型组织（例 如：Adobe®、Boeing®、Google®、IBM®、Motorola®、NASA、Skype®）、还是无数小型公司 和组织都在使用 Qt。Qt 也是流行的 Linux 桌面环境 KDE 的基础（KDE 是所有主要的 Linux 发行版的一个标准组件）。Qt4 在新增更多强大功能的同时，旨在比先前的 Qt 版本更易于 扩展和使用。Qt 的类功能全面，提供一致性接口，更易于学习使用，可减轻开发人员的工 作负担、提高编程人员的效率。另外， Qt 一直都是完全面向对象的，并且允许真正的组件编程。

Qt 软件前身为 Trolltech （奇趣科技），2008 年 6 月被诺基亚收购。更多关于 Qt Software 的信息，请访问网站 www.qtsoftware.com。

下面是 Qt4 的 Logo，Qt 通常以清新的绿色作为自己的宣传色，图中中间区域是一个大 写的 Q 字母，里面斜向嵌入了大写的 T 字母，在右上角表明了 Qt 的版本。

![](img/qt1289.jpg)

2.关于 Trolltech （奇趣科技）

图 1-1 Qt4 的 Logo

Trolltech 是由 Haavard Nord (执行总裁) 和 Eirik Chambe-Eng (总裁)于 1994 年创立的，2008 年 6 月被 NOKIA 收购。过去十几年来，Trolltech 的销售业绩持续增长。 Trolltech 采取了成功的双重授权战略，为开发者提供商业和免费软件的授权使用。 它的创始人秉持财富共享的理念，已捐献出 Trolltech 公司 5％的资产给慈善基金会。 它拥有遍布全球 60 个国家的 4400 个客户，其中包括 Adobe， IBM（国际商用机器公司），Sharp（夏普）、Siemens（西门子）以及其他全球知名公司。目前，拥有来自 17 个不同国家的 雇员。 Trolltech 公司的总部位于挪威的奥斯陆，并在澳大利亚的布里斯班，中国北京及 美国加利福尼亚的帕洛阿尔托设有办事处。

3.关于 Nokia(诺基亚)

诺基亚是移动世界的全球领先者，引领着互联网及通信融合产业的转型与发展。凭借多样化的移动终端产品、软件与服务，诺基亚为人们带来了音乐、导航、视频、电 视、影像、游戏、移动商务等丰富体验。面向用户的互联网服务的发展以及企业解决方案和软件业 务的增长是诺基亚发展的重点。此外，诺基亚还通过诺基亚西门子通信公司为通信网络提供设备、解决方案和服务。

4\. Qt 支持的平台（以 4.5 版为准）

Qt4.5 可提供于下列平台:

*   Windows (Microsoft Windows Vista,XP, 2000, 2003,NT4, Me/98)
*   WinCE
*   Mac (Mac OS X)
*   X11 (Linux, Solaris, HP-UX, IRIX, AIX, ... 以及其他 UNIX 系统)
*   Embedded Linux

表 1-1 所示为 Qt4.5 支持的平台和编译器的详细情况，表 1-2 为 Qt4.5 不支持的平台 和编译器的详细情况。

表 1-1 Qt4.5 支持的平台情况

| 软件平台 | 硬件架构 | Makespec | 编译器 |
| --- | --- | --- | --- |
| Microsoft Windows | Intel 32/64-bit | win32-g++, win32-icc, win32-msvc2003, win32-msvc2005 win32-msvc2008 | GCC 3.4.2 (MinGW) (32-bit), Intel icc, MSVC 2003, MSVC 2005 (32 and 64-bit), MSVC 2008 |
| Windows CE | Intel 32-bit, ARMv4i, MIPS | Wince-msvc2005, wince-msvc2008 | Visual Studio 2005 Visual Studio 2008 |
| Linux (32 and 64- | Intel 32/64-bit, | Linux-g++ | GCC 3.3, |
| bit) | Itanium, | linux-icc | GCC 3.4, |
| MIPS | linux-icc-32 | GCC 4.0, |
| linux-icc-64 | GCC 4.1, 4.2, 4.3 |
| Embedded Linux | ARM, | qws/linux-arm-g++, | GCC 3.4, |
| Intel 32-bit, | qws/linux-x86-g++, | GCC 4.1, |
| MIPS, | qws/linux-g++ | GCC 4.2, |
| PowerPC | GCC 4.3 |
| Apple Mac OS X (32- bit) | Intel 32/64-bit, PowerPC | Macx-g++ macx-g++42 | GCC 4.0.1, GCC 4.2 |
| Solaris | SPARC, Intel 32-bit | Solaris-cc solaris-g++ | Sun CC 5.5 GCC 3.4.2 |
| AIX | PowerPC | Aix-xlc aix-xlc-64 | xlC 6 |
| HPUX | PA/RISC,Itanium | Hpux-acc hpux-g++ hpux-g++-64 hpuxi-acc | A.03.57 (aCC 3.57) GCC 3.4.4 A.06.10 (aCC 6.10) |

表 1-2 Qt4.5 不支持的平台情况

| 软件平台 | 硬件架构 | Makespec | 编译器 |
| --- | --- | --- | --- |
| Windows XP/Vista | Intel 32/64-bit | win32-msvc | Visual C++ 6.0 |
| Windows XP/Vista | Intel 32/64-bit | win32-msvc2002 | Visual Studio 2002 |
| Windows XP/Vista | Intel 32/64-bit | win32-msvc.net | Visual Studio 2002 |
| IRIX | MIPS | irix-cc | MIPS Pro |
| IRIX | MIPS | irix-g++ | GCC 3.3 |

# 1.2 Qt 纪事概览

## 1.2 Qt 纪事概览

Qt Software 前身为 Trolltech（奇趣科技），Trolltech 始创于 1994 年

*   1996 年 Qt 上市
*   Qt 已成为数以万计的商业和开源应用程序的基础
*   Qt 的软件授权机制具有经受市场检验的双重授权（开源与商业）模式
*   Trolltech 于 2008 年 6 月被 Nokia 收购，加速了其跨平台开发战略 阅读材料：Qt 简史

Qt 工具包最初是在 1995 年 5 月变为公众可用的。它最初由 Haavard Nord(Trolltech 的 CEO)和 Eirik Chambe-Eng(Trolltech 的总裁)开发。Haavard 和 Eirik 是在位于挪威特 隆赫姆的挪威科技学院相识的，在那里他们都获得了计算机科学硕士学位。

Havvard 对 C++图形用户界面开发的兴趣始于 1988 年，当时他被一家瑞典公司委托设 计并且开发一个 C++图形用户界面工具包。

几年后，在 1990 年夏天，Havvard 和 Eirik 因为一个超声波图像方面的 C++数据库应 用程序在一起工作。这个系统要求能够在 Unix、Macintosh 和 Windows 上都能运行。那个 夏天中的一天，Haavard 和 Eirik 出去散步享受阳光。当他们坐在公园的一个长椅上， Haavard 说：“我们需要一个面向对象的显示系统。”由此引发的讨论奠定了他们即将创建 的面向对象的多平台图形用户界面工具包的智力基础。

Haavard 于 1991 年开始和 Eirik 合作设计、编写最终成为 Qt 的这些类。随后的一年， Eirik 提出了“信号和槽”的设想－一个简单并且有效的强大的图形用户界面编程范例。 Haavard 实践了这个想法，并且建立了一个手写代码实现。到 1993 年，Haavard 和 Eirik 当时已经开发出了 Qt 的第一个图形核心并且能够实现他们自己的窗口部件。同年末， Haavard 提议他们一起开展并且创建“世界上最好的 C++图形用户界面工具包”的业务。

1994 年成为两个程序员不幸的一年，他们没有客户，没有资金，只有一个未完成的产 品，却希望闯入一个稳定的市场。非常幸运的是他们的妻子都有工作并且愿意支持他们的丈 夫。在这两年里，Haavard 和 Eirik 认为需要继续开发他们的产品并且开始盈利。

他们选择“Q”作为类的前缀，是因为该字母在 Haavard 的 Emacs 字体中看起来非常漂 亮。“t”代表“工具包(toolkit)”，是从“Xt”，X 工具包中获得的灵感。公司于 1994 年 3 月 4 日创立，最初名为“Quasar Technologies”，后更名为“Troll Tech”，现在改 为“Trolltech”。

1995 年 5 月，通过 Haavard 大学时的一个教授的联系，挪威 Metis 公司与他们签订了 一份基于 Qt 进行软件开发的合同。大约同一时间，Trolltech 雇佣了 Arnt Gulbrandsen， 正是他设计并实现了一套有独创性的文档系统，并且对 Qt 的代码也作出了贡献。

1995 年 5 月 20 日，Qt 0.90 被上传到 sunsite.unc.edu。6 天后，在 comp.os.linux- announce 上发布。这是 Qt 的第一次公开发布。Qt 可以被同时用于 Windows 和 Unix 开发，

它在两种平台上提供了相同的应用程序编程接口。从第一天起， Qt 就提供两种许可版本：

一种是进行商业开发所需的商业许可版本，另一种是进行开源开发的自由软件版本。 Metis 的合同确保了 Trolltech 的发展，在 10 个月之内没有人购买 Qt 的商业许可。

1996 年，European Space Agency 购买了 10 份 Qt 商业许可，成了第 2 个 Qt 客户。凭 着坚定的信念，Eirik 和 Haavard 又雇佣了另外一个开发人员。Qt 0.97 在 5 月底发布，并 且在 1999 年 9 月 24 日，Qt1.0 面世。在这一年底，Qt 已经发展到了 1.1 的版本，共有来 自 8 个不同国家的客户，他们购买了 18 份商业许可。这一年，在 Matthias Ettrich 的带 领下，创立了 KDE 项目。

Qt 1.2 在 1997 年 4 月发布。Matthias Ettrich 利用 Qt 建立 KDE 的决定似的 Qt 成为 在 Linux 环境下开发 C++图形用户界面的实际标准。Qt1.3 在 1997 年 9 月发布。

Matthias 在 1998 年加入 Trolltech。当年 9 月最后一个 1 系列的版本 1.40 发布。 1999 年 6 月 Qt2.0 发布。Qt2.0 有很多架构上的改变，比它的前几个版本功能更为强大， 更为成熟。它还具备了 40 个新类和 Unicode 支持。Qt2 有了一个新的开源许可，Q 公共许 可(QPL，Q Public License)，它遵循了开源定义。在 1999 年 8 月，Qt 赢得了 LinuxWorld 的最佳库/工具奖。大约在这个时候，Trolltech Pty Ltd（澳大利亚）建立了。

Trolltech 在 2000 年发布了 Qt/Embedded。它被设计为可以运行在嵌入式 Linux 设备 上，并且提供了它自己的窗口系统作为 X11 的轻型替代品。现在 Qt/Embedded 和 Qt/X11 除 了提供商业许可之外，还可以提供被广泛使用的 GNU 通用许可（GPL，GNU General Public License）。到 2000 年底，Trolltech 已经创建了 Trolltech Inc.（美国），并发布了第 一个 Qtopia 版本，一个手持设备环境。Qt/Embedded 在 2001 年和 2002 年两次获得 LinuxWorld“Best Embedded Linux Solution”（最好的嵌入式 Linux 解决方案）奖。

Qt3.0 在 2001 年发布。现在 Qt 可以用于 Windows、Unix、Linux、嵌入式 Linux 和 Mac OS X。Qt3.提供了 42 个新类和超过 50 万行的代码。Qt3.0 在 2002 年赢得了 Software Development Tools 的“Jolt Productivity Aword（震撼生产力奖）”。

2005 年夏，Qt4.0 发布，它大约有 500 个类和 9000 多个函数，Qt4 比以往的任何一个 版本都要全面和丰富，并且它已经裂变成多个函数库，从而使开发人员可以根据自己的需要 只连接所需要的 Qt 部分。相对于以前的所有 Qt 版本，Qt4 的进步是巨大的，它不仅彻底的 对高效易用的模板容器、高级的模型 /视图功能、快速而灵活的二维绘图框架和强大的统一 字符编码标准的文本查看和编辑类进行了大量改进，就更不必说对那些贯穿整个 Qt 类中的 成千上万个小的改良了。现如今， Qt4 具有如此广泛的特性，以至于 Qt 已经超越了作为图 形用户界面工具包的界限，逐渐成长为一个成熟的应用程序开发框架。 Qt4 也是第一个能够 在其所有可支持的平台上既可用于商业开发又可用于开源开发的 Qt 版本。

同样在 2005 年，奇趣公司在北京开设了一家办事处，以便为中国及其销售区域内的用 户提供服务和培训，并且为 Qt/Embedded Linux 和 Qtopia 提供技术支持。

通过获取一些非官方的语言绑定件（Langauge binding），非 C++程序员也已早就开始 使用 Qt，特别是用于 Python 程序员的 PyQt 语言绑定件。2007 年，公司发布了用于 C#程序员的非官方语言绑定件 Qyoto。同年，Qt Jambi 投放市场，它是一个官方支持的 Java 版 Qt 应用程序编程接口。

自奇趣公司（现已被 NOKIA 收购）诞生以来，Qt 的声望经久不衰，而且至今仍然保持 高涨。取得这样的成绩不但说明了 Qt 的质量，而且也说明了人们都喜欢使用它。在过去的 10 年中，Qt 已经从一个只被少数专业人士所熟悉的“秘密”产品，发展到了如今遍及全世 界拥有数以千计的客户和数以万计的开源开发人员的产品。

# 1.3 Qt 套件的组成（以 Qt4.5 为准）

## 1.3 Qt 套件的组成（以 Qt4.5 为准）

自 4.5 版开始，Qt 首次以 SDK 形式发布了 Qt 套件，并在单独的安装程序中包含了完整 的 Qt SDK。

Qt SDK 在一个单独安装程序内包含了使用 Qt 进行跨平台开发所需的全部工具，其中 包括：

1.Qt Creator - 跨平台 IDE

Qt Creator 是全新的跨平台集成开发环境 (IDE)， 专为 Qt 开发人员的需求量身定 制。它包括：

*   高级 C++ 代码编辑器
*   集成的 GUI 外观和版式设计器-Qt
*   项目和生成管理工具
*   集成的上下文相关的帮助系统
*   图形化调试器（基于 GDB）

从这些话语中，我们不难看出 Nokia 全力打造 Qt Creator 的决心，意图将以前单独列 出的 Qt Designer、Qt Assistant、Qt Linguist 全部整合到 Qt Creator 中，把它们全部 作为 Qt Creator 的一部分，从而奠定 Qt Creator 的“官方出品、根正苗红”的地位。关 于 Nokia 的战略想法这里暂且不谈，虽然 Nokia 意图如此，但是笔者觉得还是有必要罗嗦 两句，向读者朋友介绍一下 Qt SDK 中的几个核心成员：

2.Qt 库

Qt Library

是一个拥有超过 400 C++类，同时不断扩展的库。它封装了用于端到端应用程序开发 所需要的所有基础结构。优秀的 Qt 应用程序接口包括成熟的对象模型，内容丰富的集合类，图形有户界面编程与布局设计功能，数据库编程，网络， XML，国际化，OpenGL 集成等等。

Qt Designer

是一个功能强大的 GUI 布局与窗体构造器，能够在所有支持平台上，以本地化的视图 外观与认知，快速开发高性能的用户界面。

Qt Assistant

是一个完全可自定义，重新分配的帮助文件或文档浏览器，又称作 Qt 助手。它的功能

类似于 MSDN，支持 html 的子集（图片、超链、文本着色）， 支持目录结构、关键字索引 和全文搜索， 可以很方便的查找 Qt 的 API 帮助文档 ，它是编程人员必备、使用频率最高的工具之一。

Qt Demo

是 Qt 例子和演示程序的加载器，有了这个工具， 用户可以很方便的查看 Qt 提供的多 姿多彩的例子程序，从中不仅可以看到程序运行的情况，还可以查看源码和文档。

qmake

是一个用于生成 Makefile（编译的规则和命令行）的命令行工具。 它是 Qt 跨平台编 译系统的基础。 它的主要特点是可以读取 Qt 本身的配置， 为程序生成平台相关的 Makefile。

uic

是一个用来编译 ui 文件的命令行工具，全称是 UI Compiler。 它能把.ui 文件转化 为编译器可以识别的标准 C++文件， 生成的文件是一个.h。 这个工具通常情况下不需要用 户去手动调用， qmake 会帮你管理.ui 文件和调用 uic 工具。

moc

是一个 用来生成一些与信号和槽相关的底层代码的预编译工具 。全称是 Meta Object Compiler， 即元对象编译器。该工具处理带有 Q_OBJECT 宏的头文件， 生成形如 moc_xxx.h, moc_xxx.cpp 的 C++代码，之后再与程序的代码一同编译。 同样，这个命令行 工具也不需要用户手动调用， qmake 会在适当的时候调用这个工具。

rcc

是一个 Qt 的资源文件编译工具。 Qt 的资源系统是自己一套特别的设计， 工程中可以 包含后缀为 qrc 的资源文件， 由 rcc 工具根据.qrc 文件中的内容将相关的文件编译为二进 制，并与源码编译在一起，保存在应用程序的二进制文件中。 这个命令行工具同样不需要 手动调用，一般由 qmake 调配使用。

qtconfig

是一个在 X11 系统下用于配置 Qt 环境的工具。 它可以设定 Qt 环境的字体、Style、 Palette、打印机等。 它的设定信息会保存在用户的 home 目录下，所以可以按不同用户的 喜好来设定不同的值。

3\. 翻译和国际化工具

Qt Linguist

是一套用来消除国际化工作流程中所带来障碍的工具，又称作 Qt 语言家。 开发小组 可把应用程序的翻译转换外包给非技术性翻译人员，从而可增加精确度，大大加快本地化处 理过程。

lupdate

是 Qt 国际化的重要命令行工具之一， 它的功能是从源码文件或其他资源文件中提取 需要翻译的字符串，并将之用正确的编码和格式存入 ts 文件中。 这个 ts 文件是 xml 格式 的普通文本文件， 但不建议用普通的文本编辑工具来编辑， 最好的方法是用 Linguist 来 处理这个文件。

lrelease

是 Qt 国际化的重要命令行工具之一， 它负责将 ts 文件转化为程序使用的 qm 文件。 转化过程最大的变化是去掉了原始文件中所有的空白和未翻译的内容， 并将存储格式压 缩， 所以 qm 文件是保留所有有效信息但占用硬盘最少的格式。

# 1.4 Qt 的授权

## 1.4 Qt 的授权

Qt 产品的提供是采用双重授权的软件许可模式。在该双重授权模式下， Qt 产品不仅可 在获得商业许可下针对专利软件开发，而且还可以在 GPL（通用公共许可证，版本 2 或版本 3）下用于开发免费和开源软件。 也就是说，Qt 这个软件本身是开源和免费使用的， 如果 你基于 GPL 协议来开发软件的话，你开发的东西都要以 GPL 协议发布－ 开源并免费提供源 码。

自从 Qt4.5 版本发布以后，Qt 通过三种授权方式提供： 商业、 LGPL 和 GPL，并且 仍然符合 Qt 的双重授权战略，表 1-3 示出了 Qt 的授权方式的简要说明，表 1-4 对比了授 权方式在具体使用时的不同。

表 1－3 Qt 的授权方式

| Qt 商业版 | Qt 商业授权适用于开发专属和/或商业软件。此版本适用于不希望与他人共享源代码，或者遵循 GNU 宽通用公共许可证 (LGPL) 2.1 版或 GNU GPL 3.0 版条款的开发人员。 |
| --- | --- |
| Qt GNU LGPL v. 2.1 | 此版本 Qt 适用于开发专属或开源 Qt 应用程序，前提条件是必须遵循 GNU LGPL 2.1 版的条款。 |
| Qt GNU GPL v. 3.0 | 如果您希望将 Qt 应用程序与受 GNU 通用公共许可证 (GPL) 3.0 版本条款限制的软件一同使用，或 者您希望 Qt 应用程序遵循该 GNU 许可证版本的条款，则此版本 Qt 适用于开发此类 Qt 应用程 序。 |

表 1－4 Qt 授权对照表

|  | 商业版 | LGPL 授权版 | GPL 授权版 |
| --- | --- | --- | --- |
| 授权收费 | 收取授权费 | 免费 | 免费 |
| 必须提供更改 Qt 的源代码 | 不需要, 更改的代码可以不公 布 | 必须提供源代码 | 必须提供源代码 |
| 可以创建专属应用程序 | 可以，不必公布源代码 | 可以，但必须遵循 LGPL v.2.1 条款 | 不可以，应用程序受 GPL 限 制，且源代码必须公开。 |
| 提供更新 | 是，仅限申请有效维护服务的 用户。 | 是，免费发布。 | 是，免费发布。 |
| 支持 | 提供，条件是维护协议必须有 效。 | 不提供，必须单独购买。 | 不提供，必须单独购买。 |
| 运行时收费 | 是 | 否 | 否 |

按照授权协议的不同，Qt 被按不同的版本发行：

Qt 商业版用于商业软件的开发，提供免费升级和技术支持服务。

Qt 开源版是 Qt 的非商业版本，是为开发自由和开放源码软件提供的 Unix/X11 版本。 在 GNU、GPL 或 LGPL 许可证下，它可以免费下载和使用。

此外，Qt 还提供了免费评估版、快照、beta 测试版、预览版等多种版本，其中免费评 估版 Qt 适用于 Windows、Mac、Linux、嵌入式 Linux 和 Windows CE 平台，它不但具备 全部功能，还带有源代码，Nokia 会在您进行评估期间提供技术支持。而快照、 beta 测试 版、预览版等版本则得不到 Qt 的支持。

### 1.4.1 Qt 开源版和商业版的不同

在网上经常看到有朋友提问，Qt 开源版和商业版到底有那些不同，有没有必要使用商 业版等问题，看来还是很有必要向大家介绍一下：

1\. 功能不尽相同

两者在源码上基本一致，但开源版缺少一些数据库插件，因为这些插件都是基于特定数据库客户端程序的，很多商业数据库的客户端程序并不是开源的，所以插件就无法开源；也就是说，开源版不支持商业数据库的驱动，一般需要大家自己写驱动或者是采用第三方的 驱动。另外，在 Windows 版本上，开源版没有 ActiveQt 这个模块，它可以用来开发 ActiveX 程序。

2.收费不同

开源版不收费，商业版根据版本不同，费用不同，一般一个 developer license 需要 大约几千美金。

3.服务不同

开源版不能享受服务，但可以到一些开放的 maillist 和论坛讨论；商业版有一年的免 费技术支持，有问题就直接发给 support@qtsoftware.com，另外商业版中还包括一年的同 产品免费下载支持。

4.协议不同

这个应该是最本质的不同，使用开源版开发需要遵循 GPL 或者 QPL，而使用商业版就没 有这个限制，大家可以看看 license agreement，原则上只要不开发和 Qt 竞争的产品就可以了。

总而言之，商业版 Qt 授权包括电子邮件(email)支持，可以获得升級，让您能够开发 完全闭源的软件。LGPL 对用户重新连接代码库的许可权有一些限制，不能提供商业数据库 如 Oracle 等的驱动，以及对 Micorsoft Office 二次开发的支持等，有时还有强加某些机 构可能不喜欢的架构要求等其他限制。除此之外，大多数情况下开源版的功能与商业版并无 二致。商业版与开源版功能的详细比较如表 1－5 所示：

表 1－5 开源版与商业版的比较

| 功能模块 | 开源版 | 商业版 |
| --- | --- | --- |
| Qt 的基本模块（工具、核心、窗口部件、对话框） 与平台无关的 Qt 图形用户界面工具包和应用类 | √ | √ |
| [Qt 设计器](http://www.qiliang.net/qt/designer-manual.html) 可视化的 Qt 图形用户界面的生成器 | √ | √ |
| [图标视图模块](http://www.qiliang.net/qt/iconview.html) 几套图形用户交互操作的可视化效果 | √ | √ |
| [工作区模块](http://www.qiliang.net/qt/workspace.html) 多文档界面（MDI）支持 | √ | √ |
| [OpenGL 三维图形模块](http://www.qiliang.net/qt/opengl.html) 在 Qt 中集成了 OpenGL | √ | √ |
| [网络模块](http://www.qiliang.net/qt/network.html) 一些套接字，TCP、FTP 和异步 DNS 查询并且与平台无关的类 | √ | √ |
| [画布模块](http://www.qiliang.net/qt/canvas.html) 为可视化效果，图表和其它而优化的二维图形领域 | √ | √ |
| [表格模块](http://www.qiliang.net/qt/table.html) 灵活的可编辑的表格/电子表格 | √ | √ |
| [XML 模块](http://www.qiliang.net/qt/xml.html) 通过 SAX 接口和 DOM 的很好的且已经成形的 XML 解析器 | √ | √ |
| [SQL 模块](http://www.qiliang.net/qt/sql.html) SQL 数据库访问类 | 部分驱动(Sqlite、 MySQL) | √ |
| ActiveQt 模块 | 支持 Office 二次开发等的模块 | x | √ |
| 售后服务和支持 | x 可单独购买服务 | √ |

如果要下载上述版本的 Qt，只需访问网址： [`www.qtsoftware.com/downloads，而商业版本还需要与`](http://www.qtsoftware.com/downloads，而商业版本还需要与) Nokia 接洽。

# 1.5 Qt 的产品

## 1.5 Qt 的产品

Qt

Qt 是一个完整的 C++应用程序开发框架。它包含一个类库和 一系列用于跨平台开发及 国际化的工具。Qt API 在所有支持的平台上都是相同的，Qt 工具在这些平台上的使用方式也一致， 因而 Qt 应用的开发和部署与平台无关。

Qtopia

Qtopia 是一个面向嵌入式 Linux 的全方位应用程序开发平台，同时也是用于基于 Linux 的 PDA（个人数字助理），智能电话（Smartphone）以及其他移动设备的用户界面。

Qt/Embedded

Qt/Embedded 是一个完整的自包含 GUI 和基于 Linux 的嵌入式平台开发工具。

# 1.6 Qt 的服务与支持

## 1.6 Qt 的服务与支持

1\. Qt 标准支持 — 12 个月

与很多人预想的有所不同，实际上，获得任何 Qt 产品的商业、LGPL 或 GPL 授权的 客户都可以获得 Qt 标准支持。这是很有吸引力的一项人性化的市场策略，也让广大用户对 Qt 产品增强信心，因为这项举措实际上表明了： Qt 不同版本的产品都具有一致的高品质和 优质服务。

标准支持主要面向的是应用程序开发人员。 Qt 在以下几个方面为客户提供一般性的建 议和指导：Qt API、功能、方法和编程技巧，乃至提供示例，还包括：产品使用、安装和技 术支持，在线程序缺陷跟踪， 产品升级提示等。

每个购买了 Qt 商业授权的客户都会获得一年的标准支持和维护服务，并且可以每年 在有效期到期前重新申请购买下一年度的支持和维护服务。Qt 标准支持还可通过使用 Qt 开源授权（例如 LGPL）方式作为单独的产品进行购买。

举个例子，如果你购买了 Qt 标准支持，那么通常会在 4 个工作日内收到针对你个人的书面解答，答复直接由进行实际操作的技术专家提供，这些专家里甚至可能包括 Qt 软件开发团队中的成员。

2\. Qt 优先支持 — 在一个工作日内回复

Qt 优先支持是在标准支持之上的升级，这需要你付出额外的费用，获得的好处是可以 在服务有效年限内通过专门的高优先级支持渠道获得 10 次优先支持，Qt 会为您指定专门 的支持工程师，他会在一个工作日内为您优先解答困惑和问题，值与不值，你可以自己衡量 一下再作出决定。

3\. Qt 的版本支持 — x.y.z 规则

Qt 的支持服务仅适用于官方发布的版本，不适用于快照、 beta 测试版、预览版和其他 不支持的版本，另外前面提到的 Qt 免费评估版则在评估期间可以享受到 Qt Software 的支 持。

Qt 对产品版本 x.y.z 提供为期 1 年的支持和维护，直到后续版本（ x.[y+1.0.0].z 或 [x+1.0.0].y.z，以先发布的为准）发布日的一年后为止。举例来说， Qt 3.3.2 版将在 Qt3.4.2 或者是 Qt4.3.2 版发布满 1 年后终止支持和维护，由于 Qt 3.4.2 先于 Qt 4.3.2 发 布，因此以 Qt3.4.2 版的发布时间为准，这就是 Qt 版本支持维护的 x.y.z 规则，听起来有 些“绕”，但当你登录到 [`www.qtsoftware.com/downloads，面对所有罗列到一起的`](http://www.qtsoftware.com/downloads，面对所有罗列到一起的) Qt 版本时，你就会明白了。

# 1.7 Qt 的最新进展

## 1.7 Qt 的最新进展

### 1.7.1 增加协议

诺基亚宣布，从 Qt 4.5 版本起，其用于桌面和嵌入式平台的 Qt 跨平台用户界面(UI) 及应用程序框架将在开源 LGPL 2.1 版授权下提供。此前，Qt 一直是在通用公共授权（GPL）下提供给开源社区的。另外，现已可以通过新的网站名称 www.qtsoftware.com 来了解 Qt 。

向 LGPL 的转移将为开源和商业开发人员提供比 GPL 更多的授权许可证，从而为开发 人员提高了灵活性。此外，Qt 源代码库將更加开放，鼓励更多來自桌面和嵌入式系统的开发人员社区的贡献。随着这些变化，开发人员将能够积极推动 Qt 框架的演进。

Qt 4.5 同时也可在商业授权条款下使用，Qt 之前版本的授权则保持不变，也就是说， 比如你要使用 Qt4.4.3 开源版的话，就需要遵守 GPL 而不是 LGPL 协议。而且，Qt 的 服务将扩展，以确保所有 Qt 开发专案，无论选择何种授权，都能获得同等支持。这一举措的效果如何呢，请看下面的来自业界的回应：

“Qt 在 LGPL 条款下的使用，让运用基于 Qt 应用程序顶端的 KDE 组件创建应用程 序的授权合理化。“ KDE e.V. 董事会成员 Sebastian Kügler 说，“这一更多权限的授 权为 Qt 和 KDE 技术的推广再次降低了门槛。KDE 团队欢迎开放开发进程，并期待以此进 一步促进 KDE 和 Qt Software 部门的协作。"

“结合诺基亚独立于操作系统的应用程序框架 Qt 和飞思卡尔的可实施软件，为 OEM 和应用程序开发人员在挑选飞思卡尔芯片时提供了特有的自由度，从而允许开发人员为其应用程序开发和维护单一的代码库。 “飞思卡尔解决方案及可实施技术副总 裁 Raja Tabet 说， “LGPL 模式是一个出色的和时效性的授权选择，这将加速结合了飞思卡尔和 Qt 的平台的推广与开发。”

“Qt 被广泛应用于 Kubuntu 和 KDE 应用程序中，Canonical 很高兴看到其在授权模 式上的这一突破，” Ubuntu 项目创始人 Mark Shuttleworth 说，“Qt 新的授权条款将帮 助我们为用户提供空前‘诱人’的应用程序。诺基亚对跨平台 Qt 库和 Linux 平台的一贯 投入，是免费软件桌面和移动设备堆栈创新的主要动力。 ”

“我们欢迎诺基亚简化 Qt 授权的举措”，Linden 实验室平台与技术开发部副总裁 Joe Miller 说，“我们发现 Qt 是耐人寻味且极具创新的技术，无论授权方式如何，这个新的授权方式已经使得我们在追求将 QtWebkit 集成到 Second Life 时所作的决策变得更为简单。”

从中我们可以看出，诺基亚的这一举措是有力的，得到了来自世界各地用户的普遍欢 迎。尤为重要的是，它的推出为 Qt 进一步的大规模商业应用扫清了障碍。

如果想要了解更多的发布信息，可以访问： [`www.qtsoftware.com/about-us-`](http://www.qtsoftware.com/about-us-) cn/licensing 。

### 1.7.2 开放源代码库

诺基亚宣布，从 2009 年 5 月起，Qt 源代码库面向公众开放，Qt 开发人员可通过为 Qt 以及与 Qt 相关的项目贡献代码、翻译、示例以及其他内容，协助引导和塑造 Qt 未来的发 展。为了便于这些内容的管理，Qt Software 启用了基于 Git 和 Gitorious 开源项目的 Web 源代码管理系统，网址为：[`qt.gitorious.org`](http://qt.gitorious.org) 。

在推出开放式 Qt 代码库的同时，Qt Software 在 qtsoftware.com 发布了其产品规划（Roadmap)。其中概述了研发项目中的最新功能，展现了现阶段对 Qt 未来发展方向的观 点，以期鼓励社区提供反馈和贡献代码，共创 Qt 的未来。

该消息以及关于贡献模式和产品规划的详细内容现在发布在官方中文网站。 想了解 更多， 请参考以下链接：

全部的消息内容：[`www.qtsoftware.com/about-us-cn/news/qt-contribution-`](http://www.qtsoftware.com/about-us-cn/news/qt-contribution-) model-announced

贡献模式：[`www.qtsoftware.com/resources-cn/the-qt-contribution-model`](http://www.qtsoftware.com/resources-cn/the-qt-contribution-model) 产品规划：[`www.qtsoftware.com/resources-cn/qt-roadmap`](http://www.qtsoftware.com/resources-cn/qt-roadmap)

### 1.7.3 确定 Qt 的发展方向

诺基亚 QtSoftware 首席技术官 Benoit Schillings 称 Qt4.5 为应用程序开发树立了标 杆。他还表示：“通过 Qt 性能方面的改进、QtCreator 的诞生和 Qt 软件开发工具包的发 布，那些寻找能够将本地内容和 Web 开发完整集成的应用框架的开发人员将如虎添翼，凭 增开发活力与灵活表现。”

从 Nokia 发布的 Qt Software RodeMap 路线图上，我们可以看到，在最新的 Qt4.5 以

及后续版本中，Qt 将在以下方向持续改进：

1.不断增强 Qt 的跨平台能力 主要体现在：

*   支持 Mac OS X Cocoa 框架
*   增加了对 Windows CE 上 Phonon 和 WebKit 模块的支持
*   推出 Qt for S60 (Tech Preview)
*   增加 Windows 7 支持
*   推出 32 位/64 位版本，更新 Qt 以便适用于 64 位 Mac。 2\. 持续提升 Qt 的性能

主要体现在：

*   提高了图形绘图性能
*   改进 Web 和混合式开发，支持动态的集成 web 和本地内容 3.不断完善 Qt 工具包

主要体现在：

*   推出 Qt Creator 并不断增强其功能
*   继续提供并改进 Eclipse 和 Visual Studio 插件
*   研究并准备推出社区和协作工具
*   支持混合式应用程序开发
*   构建高效 Build 系统 4\. 支持先进的界面开发

主要体现在：

*   推出 Qt Kinetic 项目
*   增加手势触摸功能支持
*   提供 OpenVG 支持功能
*   增加 3D 支持工具

5\. 展开 Qt 框架发展方向研究 主要体现在：

*   多媒体服务
*   混合式应用程序开发
*   内存和资源管理
*   XML Schema (模式) 支持
*   Qt 3D 可移植
*   下一代对象视图

看了上面的介绍，广大的 Qt 用户和潜在的使用者一定会极大的增强信心，毫无疑问的 是，被 NOKIA 收购后，Qt 将获得更好更快的发展，并且会一如既往的坚持开源与商业的双 重授权策略。

### 1.7.4 Qt 4.5—Qt 发展的重要里程碑

Qt4.5 的发布，可以看作是 Qt 发展史上的又一个重要的里程碑。借此， Qt 第一次提出 了“Qt EveryWhere”的口号，真正的全速前进走向了大规模的商业应用，开源社区也得到 了更加强有力的支持，尤为突出的是 Qt 的性能得到了很大的提升。用一句话来总结，就是 Qt 从未充满如此奔放的活力和富有如此强大的号召力。

由于 Qt 4.5 版是自 Trolltech 被 NOKIA 收购后，Qt 发布的首个全新版本，因此显得格 外引人注目，在国内外掀起了学习的热潮。 Qt 4.5 变化较大，在很多方面与以前的 Qt4 系 列有所不同，为了使初学者不致于走弯路，下面就对 Qt4.5 的变化给大家做一个详细的介 绍。

1\. 修改授权方式，增加 LGPL 协议 支持－Qt 更开放

Qt4.5 增加了对 LGPL 协议的支持，并继续 支持多种授权协议如 GPL、GNU 等，这为 Qt 和 KDE 的商业应用进一步扫清了障碍。

2.增加 SDK 包，可以直接安装－Qt 更易用

首次增加了 Qt SDK 包，提供了直接安装的版本，在一个单独安装程序内包含了使用

Qt 进行跨平台开发所需的全部工具，其中包含了 Qt 库、Qt Creator IDE、Qt 开发工具， 并且仍然像以前那样提供二进制的 tar 包。

3\. 大幅度提升性能－Qt 更便捷

性能提升是 Qt 4.5 的主要设计目标之一。通过以重构关键功能、采用全新的插件式 图形系统、推出全新的性能基准库－ QtBenchLib 等举措，基于 Qt 的应用程序的运行时间 性能得到了大幅提高。

更为详细的性能提升比较，请参见 Qt Labs 上的度量标准。

4\. 在 X11 上的测试平台是 Kubuntu

目前在 x11 上，Qt4.5 已在 Kubuntu8.04、8.10 上验证测试过了，但 Qt Software 并未提及其它的发行版。所以如果你想在 Linux 上使用 Qt4.5 的话，Kubuntu 将是一个不错 的选择。

5\. 区分为 32/64 位版

在 4.5 版以前，Qt 是不区分 32 位和 64 位版的，这次明确区分了，所以大家在使用时 需要注意，你的软硬件平台是否对应支持，不要 “张冠李戴”了。

6.正式支持 WinCE 这个不用多说了，以前发布的版本都是测试版。

7.支持 Symbian 上的 S60 平台

截至 09 年 5 月，Qt 发布了 Qt for S60 预先发布版 "Garden" ，正式的版本将在 09 年中发布。

8.不完全支持 MIPS

大家如果拿到了 Qt4.5 的 SDK，可以注意一下，其名字中均带有 x86 字样，经过官方 证实，目前 Qt4.5 在 MIPS（比如国产 CPU 龙芯）上还不能直接使用，要使用的话，需要采 用编译的方式安装，并且要修改某些文件的内容，步骤比较繁杂，难度较大。不过已经有网 友在龙芯上编译 Qt Creator 成功，详情可以参见 Qt 知识库网站。（见附录网址）

9.在 Mac 上支持 64 位 Cocoa

Qt 4.5 在全新的 Mac Cocoa API 基础上对 64 位应用程序开发提供支持，这样 Qt 开 发人员就可将需要大量资源的应用程序部署到最新版本的 Mac OS (10.5) 上。

10.升级至 WebKit 最新版本

在 Qt 4.5 中，Qt WebKit Integration 现已使用 WebKit 最新版本，其中包括：

*   支持 Netscape 插件 (NPAPI)，可在您的 Qt 应用程序中加入 Flash™ 内容
*   支持 HTML 5，包括缩放、基于 CSS 的动画以及更多功能
*   集成精简的 SquirrelFish JavaScript 引擎 11\. 附加许多新功能

Qt 4.5 引入了许多其他跨框架的新功能，其中包括：

*   用于 QtScript ECMA 标准 Qt 脚本引擎的全新调试器 (观看视频!)
*   支持 XSLT，可将 XML 内容转换为 XML、HTML 或其他文本
*   支持开放文档格式 (.odf)
*   改进了代理支持

12\. Qt Jambi 将交由社区开发

Qt 与 Java 编程语言绑定的最终新功能版 Qt Jambi 4.5.0_01 已经发布，根据 NOKIA 发表的声明，Qt Jambi 的开发将在一年的维护期结束后停止，以便集中资源进行 Qt 跨平 台应用和 UI 框架的开发。为了确保 Qt Jambi 实施的连续性，该项目会在

[`qt.gitorious.org`](http://qt.gitorious.org) 上保留，社区开发者仍可继续对其进行开发。

通过这次发布，Nokia 确定了 Qt Software 的发展方向－就是在保持 Qt 跨平台发展这 个主线的同时，能够适应更多“有前景”的软硬件平台，比如 Nokia 的 Symbian 操作系统 上的 S60 等，并提供对开发全生命周期提供完整的支持。

总之一句话，Qt 采用了诸多新的举措，努力使得 Qt 比以往更开放、更易用以及更便捷。

有关 Qt 4.5 包含的新功能的详细信息，请查阅 Qt 技术文档。

在不同的平台上，Qt 提供的功能是不尽相同的，表 1-6 所示为 Qt4.5 在所支持的平台 上的功能分布，表 1-7 所示为 Qt4.5 的类库的核心功能，大家可作为参考。

表 1-6 Qt4.5 在各个平台上的功能分布

| 功能模块 | Linux/X11 | Embedded Linux | Windows | Windows CE | Mac OS X |
| --- | --- | --- | --- | --- | --- |
| 拖放可视化 GUI 构 建器 | √ | √ | √ | √ | √ |
| 国际化和 翻译工具 | √ | √ | √ | √ | √ |
| 可定制的 HTML 帮 助文件阅读器 | √ | √ | √ | √ | √ |
| 集成 Eclipse 和 KDevelop IDE | √ | x | x | x | x |
| 集成 Visual Studio | x | x | √ | √ | x |
| 一整套可定制的 UI 控件或 widget | √ | √ | √ | √ | √ |
| 本地 Aqua 外观， 以及 Aqua 风格的 widget | x | x | x | x | √ |
| 集成了 OpenGL， 支持 3D 图形 | √ | √ | √ | √（OpenGL ES） | √ |
| 集成了 Direct3D® 的 3D 图形支持 | x | x | √ | x | x |
| 强大的 多线程功能 | √ | x | √ | x | √ |
| 可处理上百万个对 象的 2D 图形画布 | √ | x | √ | x | √ |
| 集成了 Phonon 多 媒体框架 | √ | √ | √ | x | √ |
| WebKit 集成 | √ | √ | √ | x | √ |
| 网络、XML 和数据 库功能 | √ | √ | √ | √ | √ |
| ECMA 标准脚本引擎 | √ | √ | √ | √ | √ |
| 紧凑高效的视窗系 统 (QWS) | x | √ | x | x | x |
| 虚拟帧缓冲 (QVFb) | x | √ | x | x | x |

表 1-7 Qt4.5 类库的核心功能

| 功能模块 | 详细内容 |
| --- | --- |
| 先进的图形用户界面（ GUI） | Qt 使用所支持平台的本地化图形 API，充分利用系统资源并给予应用程序 本地化的界面。 |
| 基于 OpenGL® 与 OpenGL® ES 的 3D 图形 | 虽然 OpenGL 完美支持 3D 图形，但却不支持创建应用程序用户界面。Qt 通过与 OpenGL 的紧密集成解决了这一难题。并且支持 Windows 平台上的 Direct3D® |
| 多线程 | Qt 的跨平台多线程功能简化了并行编程，另外它附加的同步功能可以更 加轻松地利用多核架构。 |
| 嵌入式设备的紧凑视窗系统 | 可以把基于 Qt 的应用程序直接写入 Linux 帧缓冲，解除了开发者对 X11 视窗系统的需求。 |
| 对象间通讯 | 提供信号与槽机制，使应用程序能够在不同的组件间通信 |
| 2D 图形 | Qt 给您提供一个功能强大的 2D 图形画布，用以管理和集成大量的图形元 素。 |
| 多媒体框架 | Qt 使用 Phonon 多媒体框架为众多的多媒体格式提供跨桌面与嵌入式操作 系统的回放功能。Phonon 可以轻松将音频与视频回放功能加入到 Qt 应用 程序当中，并且在每个目标平台上提取多媒体格式与框架。 |
| WebKit 集成 | Qt WebKit 集成，即 Qt 集成了 WebKit 功能，WebKit 是 KDE 项目下基于 KHTML 的开放源 web 浏览器引擎。目前 Apple®，Google™ 与 Nokia 等公 司使用 Qt WebKit 集成。 |
| 网络连接 | Qt 让您网络编程更简单，并支持跨平台网络编程 |
| XML | Qt 为 XML 文件以及 SAX 和 DOM 协议的 C++实现，提供了一个流媒体文件读写器。同时 Qt 还包含了 XQuery – 一个简单的类似 SQL 的查询语 言，用于解析 XML 文件来选择和聚合所需要的 XML 元素，并且将它们转换 成 XML 输出或其它格式的输出。 |
| 脚本引擎 | Qt 包含一个完全集成 ECMA 标准的脚本引擎。 QtScript 提供 QObject 集成，把 Qt 的信号与槽机制整合成脚本，并且实现了 C++ 与脚本的集 成。 |
| 数据库 | Qt 帮助您将数据库与您的 Qt 应用程序无缝集成，支持所有主要的数据库 驱动，并可以多种视图或数据识别表单方式显示数据 |

# 1.8 为什么选择 Qt

## 1.8 为什么选择 Qt

前面说了这么多 Qt 的介绍，相信一定有很多朋友还是要问，那么我们为什么要选择 Qt 做开发呢，它到底有哪些突出的优势呢，下面就是笔者给出的答案。

*   Qt 是基于 C++ 的一种语言扩展(Extention)

    C/C++ 目前还是一种很多人都在学习的语言. Qt 的好处就在于 Qt 本身可以被称作是一 种 C++ 的延伸。Qt 的类都是用 C++ 写出来的。这也就是说, Qt 本身已经继承了 C++的快 速、简易、面向对象等许多的优点。

*   Qt 具有非常好的可移植性（Portable）

    Qt 不只是可以在 Linux 中运行，也同样可以运行在 Microsoft Windows 、Mac OS X 等多种不同的平台中。这也意味者 ,利用 Qt 编写出来的应用程序,在几乎不用修改的情况下, 就可以同时在多种平台中运行。 Qt 的应用非常之广泛，从 Linux 到 Windows ，从 x86 到 Embedded 等都有大量 Qt 应用的成功范例。

*   Qt 支持跨平台构建（Cross-Platform Builds）

    编写用于多平台的软件是单调乏味的，且可能随时出现错误。维护编制文件更是如此，尤其是当不同的编译器和平台组合需要若干个编制文件时。通过 qmake 工具，Qt 能够很好地面对这一挑战。这个工具可以为目标平台生成准确无误的编制文件。

*   Qt 是开源软件(Open Source)

    Qt 产品提供的是采用双重授权的软件许可模式。在该双重授权模式下， Qt 产品不仅可 在获得商业许可下针对专利软件开发，而且还可以在 GPL（通用公共许可证，版本 2 或版本 3）下用于开发免费和开源软件。

*   Qt 架构健壮，性能强大(powerful)

    Qt 已由成千上万商业与开放源应用程序员，在多个操作系统与编译器上进行了测试， 奠定了高性能应用程序的基础。此外，Qt 运行时无需依赖“虚拟器”，模拟层或大容量的运行时间环境。它如本地化的应用程序一样，能够直接写入低级的图形函数，因而使用 Qt 开发的应用程序能以源代码速度执行。

*   Qt 使用起来简便高效（concise）

    Qt 统一的跨平台 API 让程序员们集中精力致力于可增值的技术革新，而无须担心维护 和管理现有应用程序多版本的基础结构与界面。 因此 Qt 开发人员仅需要学会一种 API 来 写入应用程序，该程序便可在任何地方运行。

Qt Software 投入了相当大的努力使得 Qt 使用起来尽可能简单和直观。来自世界各地 的客户反馈普遍认为 Qt 编程简单而有趣；而对于商务应用而言， Qt 可以转换为更多的功 能，并且在保持质量性能的情况下，只需更少的维护工作。

总之，Qt 可以跨平台、不依赖虚拟机机制，速度和性能不会比同类型的 Java, .NET(C#)差，这就是程序员选择 Qt 的最直接的理由了。

阅读材料

GTK+, Qt, wxWidgets 比较简评

这位来自台湾的朋友把 GTK+, Qt, wxWidgets 比较分析得相当到位。很明显的，MFC 注 定将淡出江湖了。下面就是几个跨平台库的横向比较。

之前因为把 MFC 痛骂了一顿，有网友在询问其它 GUI toolkit 的相关事项，所以小弟 分享一下个人对三大知名图形界面库的简短评论，以下纯属个人主观意见，不是专业人士， 所知有限，望前辈不吝指正或补充。

1.先讲 GTK+

GTK+ 主要用在 X Window 上，整个设计的架构和许多概念和 MFC 以及一般 Windows 上的程式开发大异其趣，入门门槛较高，而且最主要的特色是，它用不具有物件功能的纯 "C" 語言，模擬物件导向。 所以写起来比较复杂艰涩，而且充满大量巨集，使用和除错都 不是很容易，但优点则是可以用 C，不需 C++，如果和 Win32 SDK 比較，不会难学多少， 缺点是不易上手使用，而且文件比较缺，架构又非常复杂，且提供的东西比起其它无所不包 的 library，是简陋了一点，函数命名又臭又长。对于简单的程式， GTK+会显得太复杂，但 是当你开始想扩充其它 library 也都沒提供的进阶功能，就会开始赞叹 GTK+ 的架构严 谨，还有超乎想象的高度弹性。同样的东西要用 MFC 來做反而会要人命，並且对多国語言 的支援良好，內部也全面使用 UTF-8，相容性好，又是 unicode。能夠习惯的话，GTK+ 值 得推荐，但沒有很建议学，毕竟不好学，要用到熟会需要比較久，而且那样很多 C++ 的功 能会用不到。 GTK+ 有 C++ 版本叫做 GTK--，沒用过，但看文件觉得，并沒有比 gtk+ 简 单到那里去。 因为 gtk+ 本來就是物件导向，所以即使換了 c++ 語言，写起來架构还是差 不多的。 另外，gtk+ 有 Windows 版本，但缺点是，执行缓慢，不稳定，而且界面是使用 gtk+ 自己的，不是使用 Windows 內建的"Native" 原生图形界面，看起来会不太习惯。

Mac OS X 下可用 X11 來執行 gtk+，但那样出來的程式是长得像 UNIX 程式，而不是美美 的 OS X Aqua 外观。

2.再说 wxWidgets

wxWidgets 和 MFC 最接近，命名习惯或架构都高度相似，会 MFC 的话几乎不用重新学 习。它有十余年历史，此外，它的物件封裝比 MFC 要好，提供的功能也多上太多，又跨平 台。一般知名的 MFC 程式都会选择用 wxWidgets 改写，來快速移植原程式到其他平台。例 如， eMule 用 wxWidgets 移植出 aMule, xMule, 还在开发中的 Filezilla 3...等。而它 最主要的特色是，它是"跨平台"的 "Native" GUI toolkit，在各种平台上都可写出使用该 平台內建 Native 原生图形界面的程式。 在 Windows 上就長得跟其他 Windows 程式一 样，在 Linux 下就使用 gtk+ 的图形界面，在 Mac OS X 下就可以使用华丽的 Aqua 外观 风格，这点是非常強悍。 不像 gtk+ 到其它系統都还是只能用 gtk+ 自己的。缺点是，中 文支援在有些地方会出问题，例如剪贴簿的操作，得自己 patch。但仍然相当推荐，即使是 个庞大的 library，效能依旧不会太差，尤其在 Windows 上执行速度并不输 MFC，与其学 MFC，不如学 wxWidgets。

3.最后看看 Qt

Qt 的功能，应该是这三者加上 MFC 之中最強大的，文件也很完整，又有 RAD 工具可 以辅助开发，并且有商业公司做強力后盾。不但有 Windows/X Window/Mac 版本，甚至还有 嵌入式系統可用的版本，稳定性还不错，物件封装也算良好，资源比 GTK+ 或 wxWidgets 多得非常多，而且发行公司提供了相当多范例，算是一家以开放原始码成功赢利的模范公 司。 知名的 KDE 整个是用它开发，证明了它的稳定性和強大功能。缺点是如果你用它开发 非 GPL 开放程式码的软体，必須以极昂贵的金额，购买商业版本。 而它的图形界面并不完 全是 "Native GUI"，只是透过 theme 去模拟系統上的标准 GUI，所以看起來很像，却会有 些地方可以明显看出破綻。 执行速度缓慢还有过于庞大则是另一个问题。 虽然封装得很良 好文件也齐全，并不代表他就很容易学还有一个严重问题是，它写的不是标准 C++，它使用 的 signal/slot 机制必須透过 Qt 提供的 preprocessor 处理过才可以转送給编译器，这 部份可能被限定用 qmake，算是一个可惜的地方，不过暇不掩瑜，还是很推荐。忘了说，它 內部也是 unicode，多国语言没问题。

以上三套只是简单介紹，其中 Qt 的程式我沒有实际完整开发过，但明显的三套都远 远比只能在 Windows 上用，功能少 Bug 多，难学难用，几乎无多国语言支援的 MFC 要 強。三套可跨平台的 library 大家可自行选择，只能用在 Windows 的 MFC 就不用考虑 了。

这篇短评发表出来有些时日了，其中的有些观点（比如 Qt 的授权问题）已经落后于现 在的 Qt 的发展，但其中的大部分论据仍然极有说服力，清晰而简明的指出了几大类库的优 缺点，读者朋友可以从中获益。

# 1.9 问题与解答

## 1.9 问题与解答

问：LGPL 是什么，和 GPL 有什么区别

答：GNU 宽通用公共授权（GNU Lesser General Public License，或 LGPL）是由自由软件 基金会（Free Software Foundation）发布的一个免费软件授权。它被设计作为在 strong-

copyleft GNU 通用公共授权，或 GPL，和简单授权的授权（例如 BSD 授权和 MIT 授权）之

间的一个妥协，LGPL 对程序本身设置了 copyleft 限制，但这些限制不适用于仅与该程式连 接的其他软件。

这两个授权都是比较复杂的，需要仔細阅读才可以领会他们重要的区别。总的来说， GPL 要求任何衍生工作成果，比如使用 Qt 开发的应用程式都必须根据 GPL 条款重新進行授 权；而 LGPL 限制性更低，允许开发闭源应用程序。目前最新的 Qt4.5 在 LGPL 2.1 版本下 发布 Qt，并继续在 GPL 3.0 版本下提供 Qt。

问：请问版主，商业版 Qt 提供有服务，而我们开源版遇到自己不能解决的问题怎么办？

答：如果你觉得发现的问题确实是 来自于 Qt 本身，那么你也可以把它提交给 Qt 的。下面是网址：

[`www.qtsoftware.com/forms/feedbackform.html?cid=15`](http://www.qtsoftware.com/forms/feedbackform.html?cid=15) 再者，就是你可以把你的问题发到 Qt 的论坛里面，请大家一起讨论解决。关于 Qt 的论坛，在本书的附录中有详细的介绍，可以参考。

问：从哪里可以购买到 Qt 商业版

本人想使用商业版 Qt，主要是与 msvc.net 集成的版本，不知道在哪里可以购买到，在 国外和国内的价格是否有不同呢？

答：个人买的话，在下面的网页上你可以查到价格： [`www.qtsoftware.com/products-cn/pricing-1`](http://www.qtsoftware.com/products-cn/pricing-1) 你也直接和北京办事处联系一下看如何购买，网址如下： [`www.qtsoftware.com/about-us-cn/contact`](http://www.qtsoftware.com/about-us-cn/contact)

据了解,目前国际上 Qt 的价格是统一的,不存在不同地域价格有差异的问题。 在下面的网页上你可以了解到 Qt 的定价体系以及详细的支持信息，了解这些对你使用

商业版有很大的帮助：

[`www.qtsoftware.com/products-cn/pricing-1`](http://www.qtsoftware.com/products-cn/pricing-1)

问：Qt4.5 LGPL 版与商业版有何区别？

现在 Qt4.5 支持 LGPL 了,应该就是说不用开放源代码,也可以免费做商业用途了是吧? 但看它主页上还有个商业版本的,那个又是做什么用的?难道说用 LGPL 是不能用作商业的?

答：这两者是不一样的。要明确的是 LGPL 版的 Qt 也是开源版的一种，只是它遵循的协议 与 GPL 略有不同，简单来说，LGPL 允许你在不改变 Qt 源代码的条件下，开发商业应用程序 而不必开放自己的源代码，这实际上是为 Qt 的商业应用扫清了最后的障碍。

具体讲 LGPL 和商业版的主要区别如下：

首先是 LGPL 版的没有某些商业版拥有的功能(比如 ActiveQt)，同时要求你不能改变 Qt 的源代码的情况下才行；商业版的则可以改变 Qt 的源代码。此外，商业版有商业数据库驱动支持，比如 Oracle 等；运行于 Windows 的商业版有 ActiveX 支持。还有就是商业版有售后服务的支持，LGPL 版没有。

问：我想问一下，看到有些书上说只有 Qt4 的商业版才可以和 Visual Studio 结合使用，开源版只能用 MinGW,是这样吗？

答：首先你说的“结合使用”是要看程度的，Qt4 开源版可以使用 Visual Studio 作为 编译器，但不能集成 Qt 工具套件（有些特殊方法可以做到，但笔者不推荐） 。要集成使用 的话，需要使用 Qt 提供的 VS Intergration，但它只提供给商业版。

问：我使用开源版连接 sqlserver2005，用 QODBC 的，弹出提示说“Driver not loaded”，请问非商业版是不是不能连接 Sql Server？

答：是的，默认情况下，非商业版没有提供对 SQL Server 的驱动支持，但是非商业版 可以使用某些免费的第三方 ODBC 模块来连接 SQL Server。

问：请问我在商业版中编写的代码能在开源版下编译通过么，反过来呢？

答：从 Qt 的设计上看，应该是可以的，“一次生成，到处编译”是 Qt 的本质特色。 但有一个前提，就是首先要确认你的代码没有使用只有在商业版中才有的功能，然后确定你 的商业版和开源版的对应关系，最好是版本号取得一致 。最后，你在开源版中试一下，如果 可以编译并成功运行，就没有问题。反过来的话，应该是只需要对应好版本就可以了。

问：大家谁知道 Qt 授权中的“专属应用程序”是什么涵义？请指教

如题，在 Qt 官方网站上关于 Qt 授权的说明中写道：“如果您想使用 Qt 开发专属和/ 或商业软件，但又不想共享源代码，那么 Qt 商业授权是正确的授权方式”。

那么这里的“专属应用程序”或者是“专属软件”是什么意思，与商业的有什么区别呢？

答：专属是指的自有知识产权， 那个英文单词在这个语境下确实是不太好翻译，可以

简单的理解为不开源。原英文解释如下：

The Qt Commercial version is the appropriate version to use for the development of proprietary and/or commercial software.

专属软件就是上面那个 proprietary 的，其实应该是拥有产权的，私有的。 我更倾向 于理解为软件版权的归属是私有的，而不是软件的使用范围是私有的。

问：还有一个问题，也是 Qt 的授权中 提到的：“运行时收费”，又是什么含义呢？ 比如商业版，已经通过购买 License 了，为何还要运行时收费呢？

答:运行时收费就是每卖出一份软件拷贝，收取一份费用。简单的说就是按装机量收费。

# 1.10 总结与提高

## 1.10 总结与提高

Qt 是跨平台应用程序和 UI 框架，可用来编写应用程序，无须重新编写源代码，便可 跨不同的桌面和嵌入式操作系统进行部署。自 Qt 4.5 发布以来，秉承着 Nokia――不断开 发出更多令人喜爱的产品与体验的战略理念， Qt 产品家族不断增添新的举措，新增的授权 选择和新功能使 Qt 比以往更开放、更易用以及更便捷。

本章内容比较丰富，我们向大家介绍了 Qt 的发展历程、Qt 产品的概况以及 Qt 的最新 进展等内容。其中的重点是 Qt4.5 所带来的一系列重大变化，请读者朋友注意在相近的方 面加以对比学习，加深认识。比如 LGPL 协议与 GPL 协议的区别、商业版与开源版的不同 等。

在下一章中，我们将就“Qt 的安装和配置”这部分内容做一个比较深入的探讨，基本 上本章列出的 Qt 支持的平台都会涉及到，希望大家在阅读时用心体会。